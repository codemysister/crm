import{r as n,W as le,F as ae,j as e,a as te,d as L,y as se}from"./app-183ca207.js";import{I as v}from"./inputtext.esm-0c7f541c.js";import{C as ne}from"./card.esm-aad9a2fd.js";import{B as p}from"./button.esm-d3cd2157.js";import{D as re}from"./dialog.esm-202fdef4.js";import{D as A}from"./dropdown.esm-0caba294.js";import{T as de}from"./toast.esm-b97f2233.js";import{B as ie}from"./badge.esm-c550247d.js";import{I as u}from"./inputnumber.esm-6c4b14f0.js";import{C as B}from"./calendar.esm-fe4692a5.js";import{u as E}from"./UppercaseEachWord-e9d7052e.js";import{B as oe,L as ce}from"./blockui.esm-74c21695.js";import"./ripple.esm-4b355069.js";import"./portal.esm-545bb246.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-64ce51d8.js";import"./index.esm-9ef49f43.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./index.esm-d51fec0e.js";import"./index.esm-dca36cda.js";import"./progressspinner.esm-5c964cda.js";const He=({usersProp:O,partnersProp:z,salesProp:me,invoiceSubscriptionProp:r,signaturesProp:M})=>{var I,C;n.useState(O);const[V,he]=n.useState(z);n.useState(M);const[xe,H]=n.useState([]),[N,g]=n.useState(!1),[J,w]=n.useState(!1),[k,pe]=n.useState(localStorage.theme);n.useEffect(()=>{k?localStorage.theme="dark":localStorage.removeItem("theme"),localStorage.theme==="dark"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[k]);const j=n.useRef(null),f=n.useRef(null),b=n.useRef(null),h=n.useRef(null),x=n.useRef(null),y=n.useRef(null),K=n.useRef(null),$=n.useRef(null),P=n.useRef(null),U=n.useRef(null),{data:a,setData:i,post:ue,put:G,delete:fe,reset:ge,processing:T,errors:D}=le({uuid:r.uuid,code:r.code,bills:r.bills,date:r.date,due_date:r.due_date,partner:{id:r.partner_id,name:r.partner_name,province:r.partner_province,regency:r.partner_regency},total_nominal:r.total_nominal,total_ppn:r.total_ppn,total_bill:r.total_bill,rest_of_bill:r.rest_of_bill,rest_of_bill_lock:r.rest_of_bill_lock,paid_off:r.paid_off,payment_metode:r.payment_metode,xendit_link:r.xendit_link,created_by:null,signature:{name:r.signature_name,position:r.signature_position,image:r.signature_image}});n.useEffect(()=>{W()},[a.partner,N,a.paid_off]),n.useEffect(()=>{w(!!T)},[T]),n.useState({global:{value:null,matchMode:ae.CONTAINS}}),n.useState(""),document.querySelector("body").classList.add("overflow-hidden");const R=l=>{const t=new Date(l),d=t.getDate().toString().padStart(2,"0"),s=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getFullYear();return`${d}/${s}/${o}`},X=l=>e.jsx(p,{label:"OK",icon:"pi pi-check",onClick:()=>l!="product"?g(!1):onDoneSelect()}),W=()=>{const l=a.bills.reduce((d,s)=>d+s.total_bill,0),t=a.bills.reduce((d,s)=>d+s.total_ppn,0);i(d=>({...d,total_ppn:t,total_nominal:l,total_bill:l-d.paid_off}))};function q(l){try{return new URL(l),!0}catch{return!1}}const c=l=>(l.current&&(l.current.classList.add("twinkle"),l.current.focus()),null),m=l=>(l.current.classList.remove("twinkle"),null),S=(l,t)=>l?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:l.name})}):e.jsx("span",{children:t.placeholder}),F=l=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:l.name})}),Y=l=>{j.current.show({severity:"success",summary:"Success",detail:`${l} data berhasil`,life:3e3})},Z=l=>{j.current.show({severity:"error",summary:"Error",detail:`${l} data gagal`,life:3e3})},_=(l,t,d)=>{const s=[...a.bills];if(s[l][t]=d,t=="nominal"||t=="ppn"){let o=s[l].total_ppn=s[l].nominal*s[l].ppn/100,ee=s[l].nominal+o;s[l].total_bill=ee}i("bills",s)},Q=l=>{l.preventDefault(),G("/invoice_subscriptions/"+a.uuid,{onSuccess:()=>{Y("Tambah"),se.get("/invoice_subscriptions")},onError:()=>{Z("Tambah")}})};return e.jsxs(e.Fragment,{children:[e.jsx(te,{title:"Invoice Langganan"}),e.jsx(de,{ref:j}),e.jsx(oe,{blocked:J,template:ce,children:e.jsx("div",{className:"h-screen max-h-screen overflow-y-hidden",children:e.jsxs("div",{className:"flex flex-col h-screen max-h-screen overflow-hidden md:flex-row z-40 relative gap-5",children:[e.jsx("div",{className:"md:w-[35%] overflow-y-auto h-screen max-h-screen p-5",children:e.jsxs(ne,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Invoice Langganan"}),e.jsx(L,{href:"/invoice_subscriptions",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"})})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(p,{label:"Tambah Tagihan",icon:"pi pi-external-link",onClick:()=>g(!0)}),e.jsx("div",{className:"flex flex-col mt-3",children:e.jsx(v,{value:a.code,onChange:l=>i("code",l.target.value),className:"dark:bg-gray-300",id:"code","aria-describedby":"code-help",hidden:!0})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"lembaga",children:"Lembaga *"}),e.jsx(A,{value:a.partner,dataKey:"id",onChange:l=>{let t=a.bills.filter(o=>!("id"in o)),d=l.target.value.subscription,s=[...t];d&&(s=[d,...t]),i(o=>({...o,partner:{...o.partner,id:l.target.value.id,name:l.target.value.name,province:l.target.value.province,regency:l.target.value.regency},bills:s}))},onFocus:()=>{c(f)},onShow:()=>{c(f)},onHide:()=>{m(f)},options:V,optionLabel:"name",placeholder:"Pilih Lembaga",filter:!0,valueTemplate:S,itemTemplate:F,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"date",children:"Tanggal *"}),e.jsx(B,{value:a.date?new Date(a.date):null,style:{height:"35px"},onChange:l=>{i("date",l.target.value)},onFocus:()=>{c(h)},onShow:()=>{c(h)},onHide:()=>{m(h)},onBlur:()=>{m(h)},showIcon:!0,dateFormat:"dd-mm-yy",className:`w-full md:w-14rem ${D.due_date&&"p-invalid"}`})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"due_date",children:"Jatuh Tempo *"}),e.jsx(B,{value:a.due_date?new Date(a.due_date):null,style:{height:"35px"},onChange:l=>{i("due_date",l.target.value)},onFocus:()=>{c(x)},onShow:()=>{c(x)},onHide:()=>{m(x)},onBlur:()=>{m(x)},showIcon:!0,dateFormat:"dd-mm-yy",className:`w-full md:w-14rem ${D.due_date&&"p-invalid"}`})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"paid_off",children:"Terbayarkan *"}),e.jsx(u,{value:a.paid_off,onChange:l=>{i(t=>({...t,paid_off:l.value}))},onFocus:()=>{c(b)},onBlur:()=>{m(b)},defaultValue:0,className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",locale:"id-ID"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"payment_metode",children:"Metode Pembayaran *"}),e.jsx(A,{value:a.payment_metode,onChange:l=>{i("payment_metode",l.target.value)},onFocus:()=>{c(y)},onBlur:()=>{m(y)},options:[{name:"cazhbox"},{name:"payment link"}],optionLabel:"name",optionValue:"name",placeholder:"Pilih Metode Pembayaran",valueTemplate:S,itemTemplate:F,className:"w-full md:w-14rem",editable:!0})]}),a.payment_metode==="payment link"&&e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_address",children:"Link Xendit *"}),e.jsx(v,{value:a.xendit_link,onChange:l=>i("xendit_link",l.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]}),e.jsx("div",{className:"flex-flex-col mt-3",children:e.jsx("form",{onSubmit:Q,children:e.jsx(p,{className:"mx-auto justify-center block",children:"Submit"})})})]})]})}),e.jsxs(re,{header:"Input Produk",visible:N,style:{width:"85vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>g(!1),footer:X,children:[e.jsx("div",{className:"flex my-5 gap-3",children:e.jsx(p,{label:"Tambah Inputan Tagihan",icon:"pi pi-plus",onClick:()=>{let l={bill:null,nominal:0,ppn:0,total_ppn:0,total_bill:0},t=[...a.bills,l];H(d=>l),i("bills",t)}})}),(I=a.bills)==null?void 0:I.map((l,t)=>{const d=t+1;return e.jsxs("div",{className:"flex gap-5 mt-2 items-center",children:[e.jsx("div",{children:e.jsx(ie,{value:d,size:"large"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Tagihan *"}),e.jsx(v,{value:l.bill,onChange:s=>_(t,"bill",s.target.value),className:"dark:bg-gray-300",id:"bill","aria-describedby":"bill-help"})]}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"nominal",children:"Nominal *"}),e.jsx(u,{value:l.nominal,onChange:s=>_(t,"nominal",s.value),className:"dark:bg-gray-300",id:"nominal","aria-describedby":"nominal-help",locale:"id-ID"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Pajak (%)"}),e.jsx(u,{value:l.ppn,onChange:s=>_(t,"ppn",s.value),className:"dark:bg-gray-300",id:"ppn","aria-describedby":"ppn-help",keyfilter:"int",locale:"id-ID"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"total_bill",children:"Total PPN *"}),e.jsx(u,{value:l.total_ppn,className:"dark:bg-gray-300",id:"total_bill","aria-describedby":"total_bill-help",locale:"id-ID",disabled:!0})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"total_bill",children:"Jumlah *"}),e.jsx(u,{value:l.total_bill,className:"dark:bg-gray-300",id:"total_bill","aria-describedby":"total_bill-help",locale:"id-ID",disabled:!0})]})}),e.jsx("div",{className:"flex self-center pt-4 ",children:e.jsx(p,{className:"bg-red-500 h-1 w-1 shadow-md rounded-full ",icon:()=>e.jsx("i",{className:"pi pi-minus",style:{fontSize:"0.7rem"}}),onClick:()=>{const s=[...a.bills];s.splice(t,1),i(o=>({...o,bills:s}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]},l+t)})]}),e.jsxs("div",{className:"md:w-[65%] hidden md:block text-sm h-screen max-h-screen overflow-y-auto p-5",children:[e.jsx("header",{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"w-full",children:e.jsx("img",{src:"/assets/img/cazh.png",alt:"",className:"float-left w-1/3 h-1/3"})}),e.jsxs("div",{className:"w-full text-right text-xs",children:[e.jsx("h2",{className:"font-bold",children:"PT CAZH TEKNOLOGI INOVASI"}),e.jsx("p",{children:"Bonavida Park D1, Jl. Raya Karanggintung"}),e.jsx("p",{children:"Kec. Sumbang, Kab. Banyumas,"}),e.jsx("p",{children:"Jawa Tengah 53183"}),e.jsx("p",{children:"hello@cazh.id"})]})]})}),e.jsx("hr",{className:"my-[1rem] h-[1px]",style:{backgroundColor:"#718096",border:"none"}}),e.jsx("div",{class:"flex flex-col justify-center mt-10 text-center",children:e.jsx("div",{class:"font-bold text-purple-800",style:{fontSize:"18pt"},children:"INVOICE LANGGANAN"})}),e.jsxs("div",{class:"flex justify-between items-center mt-10",children:[e.jsxs("div",{className:"w-[60%]",children:[e.jsx("p",{class:"underline",children:"Ditagihkan Kepada:"}),e.jsx("p",{ref:f,class:"font-bold",children:a.partner.name??"{{lembaga}}"}),e.jsxs("p",{class:"font-bold",children:[e.jsx("span",{ref:P,children:a.partner.regency?E(JSON.parse(a.partner.regency).name):"{{kabupaten}}"}),","," ",e.jsx("span",{ref:$,children:a.partner.province?E(JSON.parse(a.partner.province).name):"{{provinsi}}"})," "]})]}),e.jsxs("div",{className:"w-[40%]",children:[e.jsxs("div",{class:"flex flex-row",children:[e.jsx("p",{className:"w-[40%]",children:"Nomor"}),e.jsx("p",{className:"w-[3%]",children:":"}),e.jsx("p",{class:"font-bold",children:"2024/I/INV/0001"})]}),e.jsxs("div",{class:"flex flex-row",children:[e.jsx("p",{className:"w-[40%]",children:"Tanggal"}),e.jsx("p",{className:"w-[3%]",children:":"}),e.jsx("p",{ref:h,children:a.date?R(a.date):"{{Tanggal}}"})]}),e.jsxs("div",{class:"flex flex-row",children:[e.jsx("p",{className:"w-[40%]",children:"Jatuh Tempo"}),e.jsx("p",{className:"w-[3%]",children:":"}),e.jsx("p",{ref:x,children:a.due_date?R(a.due_date):"{{Jatuh Tempo}}"})]})]})]}),e.jsx("div",{className:"w-full mt-10",children:e.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[e.jsx("thead",{style:{padding:"10px 10px"},className:"bg-[#D9D2E9] dark:bg-[#D1D5DB] dark:text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"5%",border:"1px solid #ded8ee",padding:"8px",textAlign:"center"},children:"No."}),e.jsx("th",{style:{width:"35%",border:"1px solid #ded8ee",padding:"8px",textAlign:"center"},children:"Tagihan"}),e.jsx("th",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px",textAlign:"center"},children:"Harga"}),e.jsx("th",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px",textAlign:"center"},children:"Pajak"}),e.jsx("th",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px",textAlign:"center"},children:"Jumlah"})]})}),e.jsxs("tbody",{children:[(C=a.bills)==null?void 0:C.map((l,t)=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"5%",textAlign:"center",border:"1px solid #ded8ee",padding:"8px"},children:t+1}),e.jsx("td",{style:{width:"35%",border:"1px solid #ded8ee",padding:"8px"},children:l.bill}),e.jsxs("td",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px"},children:["Rp",l.nominal?l.nominal.toLocaleString("id"):0]}),e.jsxs("td",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px"},children:["Rp",l.total_ppn?l.total_ppn.toLocaleString("id"):0]}),e.jsxs("td",{style:{width:"20%",border:"1px solid #ded8ee",padding:"8px"},children:["Rp",l.total_bill?l.total_bill.toLocaleString("id"):0]})]},t)),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",style:{textAlign:"right",padding:"8px"},children:"Sub Total"}),e.jsxs("td",{style:{width:"35%",border:"1px solid #ded8ee",padding:"8px"},children:["Rp",a.total_nominal?a.total_nominal.toLocaleString("id"):0]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",style:{textAlign:"right",padding:"8px"},children:"Diskon/Uang Muka"}),e.jsx("td",{style:{width:"35%",border:"1px solid #ded8ee",padding:"8px"},children:e.jsxs("span",{ref:b,children:["Rp",a.paid_off?Number(a.paid_off).toLocaleString("id"):0]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",style:{textAlign:"right",padding:"8px"},children:"Total Tagihan"}),e.jsxs("td",{className:"font-bold",style:{width:"35%",border:"1px solid #ded8ee",padding:"8px"},children:["Rp",a.total_bill?Number(a.total_bill).toLocaleString("id"):0]})]})]})]})}),e.jsxs("div",{className:"flex flex-row mt-10 justify-between items-center",children:[e.jsxs("div",{style:{width:"50%"},ref:y,children:[a.payment_metode==="payment link"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold underline",children:"Payment Link"}),e.jsx("p",{children:"Silakan klik link pembayaran berikut:"}),e.jsx("p",{ref:K,children:e.jsx(L,{className:"text-blue-600",href:q(a.xendit_link)?a.xendit_link:null,children:a.xendit_link?a.xendit_link:"{{link_xendit}}"})})]}),a.payment_metode==="cazhbox"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold underline",children:"Payment"}),e.jsx("p",{children:"Pembayaran akan dilakukan dengan"}),e.jsxs("p",{children:["mengurangi ",e.jsx("b",{children:"CazhBOX"})," ","lembaga Anda"]})]})]}),e.jsxs("div",{style:{width:"30%"},ref:U,children:[e.jsx("p",{children:"Hormat Kami,"}),a.signature.image?e.jsx("div",{className:"h-[100px] w-[170px] self-center py-2",children:e.jsx("img",{src:`${a.signature.image}`,alt:"",className:"min-h-20 w-full h-full object-fill"})}):e.jsx("div",{style:{minHeight:"100px"}}),e.jsx("p",{className:"font-bold",children:a.signature.name})]})]})]})]})})})]})};export{He as default};
