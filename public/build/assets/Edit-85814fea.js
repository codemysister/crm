import{r as l,W as ee,F as ae,j as e,a as re,d as se,y as le}from"./app-183ca207.js";import{I as m}from"./inputtext.esm-0c7f541c.js";import{C as te}from"./card.esm-aad9a2fd.js";import{B as u}from"./button.esm-d3cd2157.js";import{D as ie}from"./dialog.esm-202fdef4.js";import{D as v}from"./dropdown.esm-0caba294.js";import{T as ne}from"./toast.esm-b97f2233.js";import{B as ce}from"./badge.esm-c550247d.js";import{r as oe,p as de,F as p}from"./filepond.min-8386e795.js";import{a as me,g as pe}from"./getProvince-aa058a1f.js";import{B as xe,L as ue}from"./blockui.esm-74c21695.js";import"./ripple.esm-4b355069.js";import"./portal.esm-545bb246.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-64ce51d8.js";import"./index.esm-9ef49f43.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./progressspinner.esm-5c964cda.js";oe(de);const Ke=({usersProp:D,partnersProp:I,sla:i,signaturesProp:A,referralsProp:B})=>{var E,z,C;const[O,he]=l.useState(D),[M,P]=l.useState(!1),[H,ge]=l.useState(I),[K,N]=l.useState(!1),_=l.useRef(null),[U,J]=l.useState([]),[V,W]=l.useState([]),[w,T]=l.useState(null);l.useState(null),l.useState(A),l.useState(B);const[R,fe]=l.useState(localStorage.theme);l.useEffect(()=>{R?localStorage.theme="dark":localStorage.removeItem("theme"),localStorage.theme==="dark"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[R]);const h=l.useRef(null),g=l.useRef(null),f=l.useRef(),y=l.useRef(),S=l.useRef(),F=l.useRef(),k=l.useRef();l.useRef(),l.useRef();const G=l.useRef();l.useEffect(()=>{(async()=>{let s=await me();J(o=>s),T(o=>JSON.parse(i.partner_province).name)})()},[]),l.useEffect(()=>{(async()=>{if(w){let s=await pe(w);W(o=>s)}})()},[w]);const{data:r,setData:t,post:Z,put:je,delete:be,reset:ve,processing:L,errors:Ne}=ee({uuid:i.uuid,code:i.code,activities:i.sla_activities.map(a=>({...a,cazh_pic:{name:a.cazh_pic,id:a.user_id}})),partner:{id:i.partner_id,name:i.partner_name,phone_number:i.partner_phone_number,province:i.partner_province,regency:i.partner_regency,pic:i.partner_pic,pic_position:i.partner_pic_position,pic_number:i.partner_pic_number,pic_email:i.partner_pic_email},pic_signature:null,referral:!!i.referral,referral_name:i.referral_name,logo:null,signature:{name:i.signature_name,image:i.signature_image}});l.useEffect(()=>{P(!!L)},[L]),l.useEffect(()=>{setTimeout(()=>{t({...r,logo:i.logo,pic_signature:i.partner_pic_signature})},500)},[]),l.useState({global:{value:null,matchMode:ae.CONTAINS}}),l.useState(""),document.querySelector("body").classList.add("overflow-hidden");const $=a=>e.jsx(u,{label:"OK",icon:"pi pi-check",onClick:()=>N(!1)}),j=(a,s)=>{if(a){const o=a.name??a.user.name;return e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:o})})}return e.jsx("span",{children:s.placeholder})},b=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),c=a=>(a.current&&(a.current.classList.add("twinkle"),a.current.focus()),null),d=a=>(a.current.classList.remove("twinkle"),null),q=a=>{_.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},Y=a=>{_.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},x=(a,s,o)=>{const n=[...r.activities];n[a][s]=o,t("activities",n)},Q=a=>{a.preventDefault(),Z("/sla/"+r.uuid,{onSuccess:()=>{q("Tambah"),le.get("/sla")},onError:()=>{Y("Tambah")}})};return e.jsxs(e.Fragment,{children:[e.jsx(re,{title:"Service Level Agreement"}),e.jsx(ne,{ref:_}),e.jsx(xe,{blocked:M,template:ue,children:e.jsx("div",{className:"h-screen max-h-screen overflow-y-hidden",children:e.jsxs("div",{className:"flex flex-col h-screen max-h-screen overflow-hidden md:flex-row z-40 relative gap-5",children:[e.jsx("div",{className:"md:w-[35%] overflow-y-auto h-screen max-h-screen p-5",children:e.jsxs(te,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Service Level Agreement"}),e.jsx(se,{href:"/sla",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"})})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(u,{label:"Tambah Aktivitas",icon:"pi pi-external-link",onClick:()=>N(!0)}),e.jsx("div",{className:"flex flex-col mt-3",children:e.jsx(m,{value:r.code,onChange:a=>t("code",a.target.value),className:"dark:bg-gray-300",id:"code","aria-describedby":"code-help",hidden:!0})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"logo",children:"Logo"}),e.jsx("div",{className:"App",children:r.logo!==null&&typeof r.logo=="string"?e.jsx(e.Fragment,{children:e.jsx(p,{files:r.logo,onaddfile:(a,s)=>{a||t("logo",s.file)},onremovefile:()=>{t("logo",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(p,{onaddfile:(a,s)=>{a||t("logo",s.file)},onremovefile:()=>{t("logo",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"lembaga",children:"Lembaga *"}),e.jsx(v,{value:r.partner,dataKey:"id",onChange:a=>{t("partner",{...r.partner,id:a.target.value.id,name:a.target.value.name,phone_number:a.target.value.phone_number,pic:a.target.value.pic})},onFocus:()=>{c(f)},onShow:()=>{c(f)},onHide:()=>{d(f)},options:H,optionLabel:"name",placeholder:"Pilih Lembaga",filter:!0,valueTemplate:j,itemTemplate:b,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"province",children:"Provinsi *"}),e.jsx(v,{value:r.partner.province?JSON.parse(r.partner.province):null,onChange:a=>{T(s=>a.target.value.code),t("partner",{...r.partner,province:JSON.stringify(a.target.value),regency:null})},dataKey:"code",options:U,optionLabel:"name",placeholder:"Pilih Provinsi",filter:!0,valueTemplate:j,itemTemplate:b,className:"w-full md:w-14rem",onFocus:()=>{c(h)},onShow:()=>{c(h)},onHide:()=>{d(h)}})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"regency",children:"Kabupaten *"}),e.jsx(v,{value:r.partner.regency?JSON.parse(r.partner.regency):null,onChange:a=>{t("partner",{...r.partner,regency:JSON.stringify(a.target.value)})},onFocus:()=>{c(g)},onShow:()=>{c(g)},onHide:()=>{d(g)},dataKey:"code",options:V,optionLabel:"name",placeholder:"Pilih Kabupaten",filter:!0,valueTemplate:j,itemTemplate:b,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_address",children:"Nomor Telepon Lembaga *"}),e.jsx(m,{value:r.partner.phone_number,onChange:a=>t("partner",{...r.partner,phone_number:a.target.value}),keyfilter:"int",onFocus:()=>{c(y)},onBlur:()=>{d(y)},className:"dark:bg-gray-300",id:"partner_phone_number","aria-describedby":"partner_phone_number-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_pic",children:"Penanggungjawab *"}),e.jsx(m,{value:r.partner.pic,onChange:a=>t("partner",{...r.partner,pic:a.target.value}),onFocus:()=>{c(S)},onBlur:()=>{d(S)},className:"dark:bg-gray-300",id:"partner_pic","aria-describedby":"partner_pic-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_pic_email",children:"Email Penanggungjawab *"}),e.jsx(m,{value:r.partner.pic_email??"",onChange:a=>{t("partner",{...r.partner,pic_email:a.target.value})},onFocus:()=>{c(F)},onBlur:()=>{d(F)},className:"dark:bg-gray-300",id:"partner_pic_email","aria-describedby":"partner_pic_email-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_pic_number",children:"Nomor HP Penanggungjawab *"}),e.jsx(m,{value:r.partner.pic_number,onChange:a=>t("partner",{...r.partner,pic_number:a.target.value}),onFocus:()=>{c(k)},onBlur:()=>{d(k)},keyfilter:"int",className:"dark:bg-gray-300",id:"partner_pic_number","aria-describedby":"partner_pic_number-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"signature",children:"Tanda Tangan PIC"}),e.jsx("div",{className:"App",children:r.signature.image!==null&&typeof r.signature.image=="string"?e.jsx(e.Fragment,{children:e.jsx(p,{files:r.signature.image,onaddfile:(a,s)=>{a||t({...r,signature:{...r.signature,image:s.file}})},onremovefile:()=>{t({...r,signature:{...r.signature,image:null}})},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(p,{onaddfile:(a,s)=>{a||t({...r,signature:{...r.signature,image:s.file}})},onremovefile:()=>{t({...r,signature:{...r.signature,image:null}})},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"signature",children:"Tanda Tangan PIC"}),e.jsx("div",{className:"App",children:r.pic_signature!==null&&typeof r.pic_signature=="string"?e.jsx(e.Fragment,{children:e.jsx(p,{files:r.pic_signature,onaddfile:(a,s)=>{a||t("pic_signature",s.file)},onremovefile:()=>{t("pic_signature",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(p,{onaddfile:(a,s)=>{a||t("pic_signature",s.file)},onremovefile:()=>{t("pic_signature",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]}),e.jsx("div",{className:"flex-flex-col mt-3",children:e.jsx("form",{onSubmit:Q,children:e.jsx(u,{className:"mx-auto justify-center block",children:"Submit"})})})]})]})}),e.jsxs(ie,{header:"Input Produk",visible:K,style:{width:"85vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>N(!1),footer:$,children:[e.jsx("div",{className:"flex my-5 gap-3",children:e.jsx(u,{label:"Tambah Inputan",icon:"pi pi-plus",onClick:()=>{let a={activity:null,cazh_pic:{name:null},duration:null,estimation_date:null,realization_date:null,link_drive_proof:null},s=[...r.activities,a];t("activities",s)}})}),(E=r.activities)==null?void 0:E.map((a,s)=>{const o=s+1;return e.jsxs("div",{className:"flex gap-5 mt-2 items-center",children:[e.jsx("div",{children:e.jsx(ce,{value:o,className:"rounded-full",size:"large"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Tahapan *"}),e.jsx(m,{value:a.activity,onChange:n=>x(s,"activity",n.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Penanggungjawab *"}),e.jsx(v,{dataKey:"name",value:a.cazh_pic,onChange:n=>{x(s,"cazh_pic",n.target.value)},options:O,optionLabel:"name",placeholder:"Pilih Penanggungjawab",filter:!0,valueTemplate:j,itemTemplate:b,className:"w-full min-w-[14rem] md:w-14rem"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"duration",children:"Estimasi Waktu *"}),e.jsx(m,{value:a.duration,onChange:n=>x(s,"duration",n.target.value),className:"dark:bg-gray-300",id:"duration","aria-describedby":"duration-help"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"duration",children:"Estimasi Waktu *"}),e.jsx("input",{type:"date",id:"birthday",name:"birthday",value:a.estimation_date,style:{height:"35px"},className:"rounded-md border-gray-400 text-sm",onChange:n=>{x(s,"estimation_date",n.target.value)}})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"duration",children:"Realisasi"}),e.jsx("input",{type:"date",id:"birthday",name:"birthday",value:a.realization_date,style:{height:"35px"},onChange:n=>{x(s,"realization_date",n.target.value)},className:"rounded-md border-gray-400 text-sm"})]})}),e.jsx("div",{className:"flex self-center pt-4",children:e.jsx(u,{className:"bg-red-500 h-1 w-1 shadow-md rounded-full ",icon:()=>e.jsx("i",{className:"pi pi-minus",style:{fontSize:"0.7rem"}}),onClick:()=>{const n=[...r.activities];n.splice(s,1),t(X=>({...X,activities:n}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]},a+s)})]}),e.jsxs("div",{className:"md:w-[65%] hidden md:block text-xs h-screen max-h-screen overflow-y-auto p-5",children:[e.jsx("header",{children:e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx("div",{className:"w-[10%]",children:r.logo&&e.jsx("img",{src:typeof r.logo=="object"?URL.createObjectURL(r.logo):r.logo,alt:"",className:"float-left w-full h-full"})}),e.jsxs("div",{className:"w-full text-center ",children:[e.jsx("h2",{className:"font-bold",children:"PT CAZH TEKNOLOGI INOVASI"}),e.jsx("h2",{className:"font-bold",children:"TIME LINE PROSES IMPLEMENTASI LAYANAN CAZH CARDS"})]}),e.jsx("div",{className:"w-[10%]",children:r.referral_logo&&e.jsx("img",{src:"/storage/"+r.referral_logo,alt:"",className:"float-left w-full h-full"})})]})}),e.jsx("hr",{className:"h-[2px] my-2 bg-slate-400"}),e.jsx("div",{className:"w-full mt-5",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Nama Lembaga"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsx("td",{className:"text-xs w-7/12",children:e.jsx("span",{ref:f,children:r.partner.name??"{{nama_lembaga}}"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Alamat Lembaga"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsxs("td",{className:"text-xs w-7/12",children:[e.jsx("span",{ref:g,children:r.partner.regency?JSON.parse(r.partner.regency).name:"{{kabupaten}}"}),","," ",e.jsx("span",{ref:h,children:r.partner.province?JSON.parse(r.partner.province).name:"{{provinsi}}"})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Nomor Telepon Lembaga"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsx("td",{className:"text-xs w-7/12",children:e.jsx("span",{ref:y,children:r.partner.phone_number??"{{nomor_hp_lembaga}}"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Penanggungjawab"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsx("td",{className:"text-xs w-7/12",children:e.jsx("span",{ref:S,children:r.partner.pic??"{{pic_lembaga}}"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Email Penanggungjawab"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsx("td",{className:"text-xs w-7/12",children:e.jsx("span",{ref:F,children:r.partner.pic_email??"{{pic_email}}"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-xs w-1/5",children:"Nomor HP Penanggungjawab"}),e.jsx("td",{className:"text-xs w-[1%]",children:":"}),e.jsx("td",{className:"text-xs w-7/12",children:e.jsx("span",{ref:k,children:r.partner.pic_number??"{{nomor_hp_pic}}"})})]})]})})}),e.jsx("div",{className:"w-full text-xs mt-5",children:e.jsxs("table",{className:"w-full border  border-collapse ",border:1,children:[e.jsxs("thead",{className:"text-left",children:[e.jsx("th",{className:"border p-2 text-center",children:"No"}),e.jsx("th",{className:"border p-2 text-center",children:"Tahapan"}),e.jsx("th",{className:"border p-2 text-center",children:"Penanggungjawab"}),e.jsx("th",{className:"border p-2 text-center",children:"Estimasi Waktu"}),e.jsx("th",{className:"border p-2 text-center",children:"Tanggal"}),e.jsx("th",{className:"border p-2 text-center",children:"Realisasi"})]}),e.jsxs("tbody",{children:[((z=r.activities)==null?void 0:z.length)==0&&e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:6,className:"border",children:"Aktivitas belum ditambah"})}),(C=r.activities)==null?void 0:C.map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:" border text-center",children:++s}),e.jsx("td",{className:"border p-1",children:a.activity}),e.jsx("td",{className:"border text-center p-1",children:e.jsx("i",{children:a.cazh_pic.name})}),e.jsx("td",{className:"border text-center p-1",children:a.duration}),e.jsx("td",{className:"border text-right p-1",children:a.estimation_date!==null?new Date(a.estimation_date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):""}),e.jsx("td",{className:"border text-right p-1",children:a.realization_date!==null?new Date(a.realization_date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):""})]},a.activity+s))]})]})}),e.jsxs("div",{className:"flex text-xs flex-row mt-5 justify-between",children:[e.jsxs("div",{className:"w-[30%]",ref:G,children:[e.jsx("p",{children:"Pihak Pertama"}),e.jsx("div",{className:"h-[100px] w-[170px] py-2",children:r.signature.image!==null?e.jsx("img",{src:typeof r.signature.image=="string"?r.signature.image:URL.createObjectURL(r.signature.image),alt:"",className:"w-full h-full object-fill"}):e.jsx("div",{className:"min-h-20"})}),e.jsx("p",{children:e.jsx("b",{children:r.signature.name??"{{nama_pihak_pertama}}"})})]}),e.jsxs("div",{className:"w-[30%]",children:[e.jsx("p",{children:"Pihak Kedua"}),r.pic_signature?e.jsx("div",{className:"h-[100px] w-[170px] py-2",children:e.jsx("img",{src:typeof r.pic_signature=="string"?r.pic_signature:URL.createObjectURL(r.pic_signature),className:"w-full h-full object-fill"})}):e.jsx("div",{className:"min-h-20"}),e.jsx("p",{children:e.jsx("b",{children:r.partner.pic??"{{nama_pihak_kedua}}"})})]})]})]})]})})})]})};export{Ke as default};
