import{r as l,F as ee,W as ae,j as e,R as re}from"./app-183ca207.js";import{D as E,C as i}from"./column.esm-1f1d87c0.js";import{T as se}from"./toast.esm-b97f2233.js";import{B as d}from"./button.esm-d3cd2157.js";import{D as I}from"./DashboardLayout-217cf030.js";import{H as te}from"./HeaderModule-b06ca799.js";import{D as M}from"./dialog.esm-202fdef4.js";import{I as le}from"./inputtext.esm-0c7f541c.js";import{D as p}from"./dropdown.esm-0caba294.js";import{C as ie,c as ne}from"./confirmdialog.esm-3c4cbf5c.js";import{S as u}from"./skeleton.esm-b303042b.js";import{F as g,r as de,p as oe}from"./filepond.min-8386e795.js";import{I as me}from"./image.esm-891e62e4.js";import"./ripple.esm-4b355069.js";import"./inputnumber.esm-6c4b14f0.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./portal.esm-545bb246.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./Dropdown-b69220a2.js";import"./index.esm-32ebe3f0.js";de(oe);function _e({auth:h,signaturesProp:z,rolesProp:B,usersProp:L}){const[w,ce]=l.useState(L),[P,R]=l.useState(z),[S,pe]=l.useState(B),[A,x]=l.useState(!1),H=Array.from({length:5},(a,r)=>r),[V,U]=l.useState(!0),[K,f]=l.useState(!1),[_,b]=l.useState(!1),j=l.useRef(null),{roles:ue,permissions:k}=h.user,[F,G]=l.useState({global:{value:null,matchMode:ee.CONTAINS}}),{data:t,setData:s,post:T,put:ge,delete:O,reset:y,processing:C,errors:he}=ae({id:null,user:{name:null,id:null},image:null,position:null}),[W,$]=l.useState(""),q=a=>{const r=a.target.value;let n={...F};n.global.value=r,G(n),$(r)},o=async()=>{x(!0);let r=await(await fetch("/api/signatures")).json();R(n=>r),x(!1)};l.useEffect(()=>{(async()=>{try{await Promise.all([o()]),x(!1),U(r=>r=!1)}catch(r){console.error("Error fetching data:",r)}})()},[]);const J=a=>e.jsxs(re.Fragment,{children:[k.includes("edit produk")&&e.jsx(d,{icon:"pi pi-pencil",rounded:!0,outlined:!0,className:"mr-2",onClick:()=>Q(a)}),k.includes("hapus produk")&&e.jsx(d,{icon:"pi pi-trash",rounded:!0,outlined:!0,severity:"danger",onClick:()=>{X(a)}})]}),v=a=>{j.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},N=a=>{j.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},Q=a=>{s(r=>({...r,uuid:a.uuid,user:{name:a.name,id:a.user_id},image:a.image,position:a.position})),b(!0)},X=a=>{ne({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:async()=>{O("signatures/"+a.uuid,{onSuccess:()=>{o(),v("Hapus")},onError:()=>{N("Hapus")}})}})},m=(a,r)=>a?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}):e.jsx("span",{children:r.placeholder}),c=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),Y=(()=>e.jsx("div",{className:"flex flex-row justify-left gap-2 align-items-center items-end",children:e.jsx("div",{className:"w-[30%]",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search dark:text-white"}),e.jsx(le,{className:"dark:bg-transparent dark:placeholder-white",value:W,onChange:q,placeholder:"Keyword Search"})]})})}))(),Z=()=>e.jsx("i",{className:"pi pi-plus",style:{fontSize:"0.7rem",paddingRight:"5px"}}),D=(a,r)=>{a.preventDefault(),r==="tambah"?T("/signatures",{onSuccess:()=>{v("Tambah"),f(n=>!1),o(),y()},onError:()=>{N("Tambah")}}):T("/signatures/"+t.uuid,{onSuccess:()=>{v("Tambah"),b(n=>!1),o(),y()},onError:()=>{N("Update")}})};return V?e.jsx(e.Fragment,{children:e.jsx(I,{auth:h.user,className:"",children:e.jsx("div",{className:"card my-5",children:e.jsxs(E,{value:H,className:"p-datatable-striped dark:bg-slate-900",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:"dark:bg-transparent"},children:[e.jsx(i,{style:{width:"25%"},body:e.jsx(u,{}),headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{style:{width:"25%"},body:e.jsx(u,{}),headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{style:{width:"25%"},body:e.jsx(u,{}),headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{style:{width:"25%"},body:e.jsx(u,{}),headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300"})]})})})}):e.jsxs(I,{auth:h.user,className:"",children:[e.jsx(se,{ref:j}),e.jsx(ie,{}),e.jsx(te,{title:"Tanda Tangan",children:k.includes("tambah produk")&&e.jsx(d,{label:"Tambah",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2",icon:Z,onClick:()=>{f(a=>!0),y("name","category","price","unit","description")},"aria-controls":"popup_menu_right","aria-haspopup":!0})}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(M,{header:"Tanda Tangan",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:K,onHide:()=>f(!1),children:e.jsxs("form",{onSubmit:a=>D(a,"tambah"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Nama"}),e.jsx(p,{dataKey:"name",value:t.user,onChange:a=>{s(r=>({...r,user:{name:a.target.value.name,id:a.target.value.id},position:a.target.value.position}))},options:w,optionLabel:"name",placeholder:"Pilih User",filter:!0,valueTemplate:m,itemTemplate:c,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"image",children:"Upload Tanda Tangan"}),e.jsx("div",{className:"App",children:t.image!==null&&typeof t.image=="string"?e.jsx(e.Fragment,{children:e.jsx(g,{files:"/storage/"+t.image,onaddfile:(a,r)=>{a||s("image",r.file)},onremovefile:()=>{s("image",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(g,{onaddfile:(a,r)=>{a||s("image",r.file)},onremovefile:()=>{s("image",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Divisi"}),e.jsx(p,{value:t.position,onChange:a=>{s("position",a.target.value)},options:S,optionLabel:"name",optionValue:"name",placeholder:"Pilih Divisi",filter:!0,valueTemplate:m,itemTemplate:c,className:"w-full md:w-14rem"})]}),e.jsx("div",{className:"flex justify-center my-5",children:e.jsx(d,{label:"Submit",disabled:C,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(M,{header:"Tanda Tangan",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:_,onHide:()=>b(!1),children:e.jsxs("form",{onSubmit:a=>D(a,"update"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Nama"}),e.jsx(p,{dataKey:"name",value:t.user,onChange:a=>{s(r=>({...r,user:{name:a.target.value.name,id:a.target.value.id},position:a.target.value.position}))},options:w,optionLabel:"name",placeholder:"Pilih User",filter:!0,valueTemplate:m,itemTemplate:c,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"image",children:"Upload Tanda Tangan"}),e.jsx("div",{className:"App",children:t.image!==null&&typeof t.image=="string"?e.jsx(e.Fragment,{children:e.jsx(g,{files:"/storage/"+t.image,onaddfile:(a,r)=>{a||s("image",r.file)},onremovefile:()=>{s("image",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(g,{onaddfile:(a,r)=>{a||s("image",r.file)},onremovefile:()=>{s("image",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Divisi"}),e.jsx(p,{value:t.position,onChange:a=>{s("position",a.target.value)},options:S,optionLabel:"name",optionValue:"name",placeholder:"Pilih Divisi",filter:!0,valueTemplate:m,itemTemplate:c,className:"w-full md:w-14rem"})]}),e.jsx("div",{className:"flex justify-center my-5",children:e.jsx(d,{label:"Submit",disabled:C,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})}),e.jsx("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",children:e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(E,{loading:A,className:"w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:""},paginator:!0,filters:F,rows:5,emptyMessage:"Tanda tangan tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:Y,globalFilterFields:["name"],value:P,dataKey:"id",children:[e.jsx(i,{header:"No",body:(a,{rowIndex:r})=>r+1,style:{width:"5%"},className:"dark:border-none pl-6",headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{field:"uuid",hidden:!0,className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",header:"Nama",align:"left",style:{width:"10%"}}),e.jsx(i,{field:"name",className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",header:"Nama",align:"left",style:{width:"20%"}}),e.jsx(i,{field:"image",header:"Tanda Tangan",headerClassName:"dark:border-none pl-6 bg-transparent dark:bg-transparent dark:text-gray-300",body:a=>a.image?e.jsx("div",{className:"flex justify-center",children:e.jsx(me,{src:"/storage/"+a.image,alt:"Bukti",width:"50%",height:"50%",preview:!0,downloadable:!0})}):"-",style:{width:"10rem"}}),e.jsx(i,{field:"position",className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",header:"Divisi",align:"left",style:{width:"15%"}}),e.jsx(i,{header:"Action",body:J,style:{minWidth:"12rem"},className:"dark:border-none",headerClassName:"dark:border-none  bg-transparent dark:bg-transparent dark:text-gray-300"})]})})})]})}export{_e as default};
