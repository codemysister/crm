import{r as s,F as ge,W as fe,j as e,a as je,d as ve,y as be}from"./app-183ca207.js";import{I as d}from"./inputtext.esm-0c7f541c.js";import{C as ye}from"./card.esm-aad9a2fd.js";import{B as w}from"./button.esm-d3cd2157.js";import{D as Ne,C as k}from"./column.esm-1f1d87c0.js";import{D as we}from"./dialog.esm-202fdef4.js";import{C as L}from"./calendar.esm-fe4692a5.js";import{D as S}from"./dropdown.esm-0caba294.js";import{T as ke}from"./toast.esm-b97f2233.js";import{B as Se,L as Te}from"./blockui.esm-74c21695.js";import{a as Fe,g as De}from"./getProvince-aa058a1f.js";import{D as Ce}from"./DialogInstitution-405a9aff.js";import{u as Ke}from"./UppercaseEachWord-e9d7052e.js";import"./ripple.esm-4b355069.js";import"./portal.esm-545bb246.js";import"./inputnumber.esm-6c4b14f0.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./index.esm-d51fec0e.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./progressspinner.esm-5c964cda.js";import"./formatNPWP-cf5b7efc.js";import"./badge.esm-c550247d.js";import"./HeaderDatatable-497e5508.js";const xa=({stpd:r,usersDefault:B,partnersDefault:E,signaturesProp:O})=>{var A,I;const[J,Re]=s.useState(B),[V,M]=s.useState(E),[H,Pe]=s.useState(O),[U,p]=s.useState(!1),[z,_e]=s.useState(!0),g=s.useRef(null),[G,W]=s.useState([]),[Y,$]=s.useState([]),[q,T]=s.useState(!1),[Z,Q]=s.useState(!1),[X,ee]=s.useState(null),[f,j]=s.useState(null);s.useState(null);const[ae,F]=s.useState(!1),[D,Ae]=s.useState(localStorage.theme);s.useEffect(()=>{D?localStorage.theme="dark":localStorage.removeItem("theme"),localStorage.theme==="dark"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[D]);const C=s.useRef(null),m=s.useRef(null),u=s.useRef(null),v=s.useRef(null),b=s.useRef(null),h=s.useRef(null),x=s.useRef(null),[y,K]=s.useState({global:{value:null,matchMode:ge.CONTAINS}}),[te,se]=s.useState(""),re=a=>{const n=a.target.value;let o={...y};o.global.value=n,K(o),se(n)},l=a=>(a.current&&(a.current.classList.add("twinkle"),a.current.focus()),null),c=a=>(a.current.classList.remove("twinkle"),null);document.querySelector("body").classList.add("overflow-hidden");const{data:t,setData:i,post:Ie,put:ne,delete:Le,reset:le,processing:R,errors:Be}=fe({uuid:r.uuid,code:r.code,employees:r.employees,partner:{uuid:r.partner==null?r.lead.uuid:r.partner.uuid,name:r.institution_name,province:r.institution_province,regency:r.institution_regency,type:r.partner==null?"lead":"partner"},departure_date:r.departure_date,return_date:r.return_date,transportation:r.transportation,accommodation:r.accommodation,signature:{name:r.signature_name,image:r.signature_image,position:r.signature_position},stpd_doc:""});s.useEffect(()=>{const a=async()=>{let n=await Fe();W(o=>n)};j(JSON.parse(t.partner.province).name),a()},[]),s.useEffect(()=>{F(!!R)},[R]),s.useEffect(()=>{(async()=>{if(f){let n=await De(f);$(o=>n)}})()},[f]);const ie=()=>e.jsx(w,{label:"OK",icon:"pi pi-check",onClick:()=>p(!1)}),P=a=>{if(!a)return"N/A";a=new Date(a);let n=a.getDate(),o=a.getMonth()+1,he=a.getFullYear(),xe=o<10?"0"+o:o,pe=he;return n+"/"+xe+"/"+pe},N=(a,n)=>a?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}):e.jsx("span",{children:n.placeholder}),oe=a=>e.jsxs("div",{className:"flex flex-wrap p-2 align-items-center items-center gap-3",children:[e.jsx("img",{className:"w-[6rem] shadow-2 flex-shrink-0 border-round",src:"/storage/"+a.image,alt:a.name}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2 xl:mr-8",children:[e.jsx("span",{className:"font-bold",children:a.name}),e.jsx("div",{className:"flex align-items-center gap-2",children:e.jsx("span",{children:a.position})})]})]}),_=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),ce=e.jsx("div",{className:"flex flex-row justify-left gap-2 align-items-center items-end",children:e.jsx("div",{className:"w-[30%]",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search dark:text-white"}),e.jsx(d,{className:"dark:bg-transparent dark:placeholder-white",value:te,onChange:re,placeholder:"Keyword Search"})]})})}),de=a=>{g.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},me=a=>{g.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},ue=a=>{a.preventDefault(),ne("/stpd/"+t.uuid,{onSuccess:()=>{de("Tambah"),be.get("/stpd")},onError:()=>{me("Tambah")}})};return e.jsxs(e.Fragment,{children:[e.jsx(je,{title:"Surat Keterangan Perjalanan Dinas"}),e.jsx(ke,{ref:g}),e.jsx(Se,{blocked:ae,template:Te,children:e.jsx("div",{className:"h-screen max-h-screen overflow-y-hidden",children:e.jsxs("div",{className:"flex flex-col h-screen max-h-screen overflow-hidden md:flex-row z-40 relative gap-5",children:[e.jsx("div",{className:"md:w-[35%] overflow-y-auto h-screen max-h-screen p-5",children:e.jsxs(ye,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"font-bold text-xl",children:"Surat Keterangan Perjalanan Dinas"}),e.jsx(ve,{href:"/stpd",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"})})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(w,{label:"Tambah karyawan",icon:"pi pi-external-link",onClick:()=>p(!0)}),e.jsx("div",{className:"flex flex-col mt-3",children:e.jsx(d,{value:t.code,onChange:a=>i("code",a.target.value),className:"dark:bg-gray-300",id:"code","aria-describedby":"code-help",hidden:!0})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"lembaga",children:"Lembaga *"}),e.jsx(d,{value:t.partner.name,onFocus:()=>{l(C)},onBlur:()=>{c(C)},onClick:()=>{T(!0)},placeholder:"Pilih lembaga",className:"dark:bg-gray-300 cursor-pointer",id:"partner","aria-describedby":"partner-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"province",children:"Provinsi *"}),e.jsx(S,{value:t.partner.province?JSON.parse(t.partner.province):null,onChange:a=>{j(n=>a.target.value.code),i("partner",{...t.partner,province:JSON.stringify(a.target.value)})},dataKey:"code",options:G,optionLabel:"name",placeholder:"Pilih Provinsi",filter:!0,valueTemplate:N,itemTemplate:_,className:"w-full md:w-14rem",onFocus:()=>{l(h)},onShow:()=>{l(h)},onBlur:()=>{c(h)}})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"regency",children:"Kabupaten *"}),e.jsx(S,{dataKey:"code",value:t.partner.regency?JSON.parse(t.partner.regency):null,onChange:a=>{i("partner",{...t.partner,regency:JSON.stringify(a.target.value)})},onFocus:()=>{l(x)},onShow:()=>{l(x)},onBlur:()=>{c(x)},options:Y,optionLabel:"name",placeholder:"Pilih Kabupaten",filter:!0,valueTemplate:N,itemTemplate:_,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"register_date",children:"Tanggal Berangkat *"}),e.jsx(L,{value:t.departure_date?new Date(t.departure_date):null,style:{height:"35px"},onChange:a=>{new Date(a.target.value).toISOString().split("T")[0],i("departure_date",a.target.value)},onFocus:()=>{l(m)},onShow:()=>{l(m)},onHide:()=>{c(m)},showIcon:!0,dateFormat:"dd/mm/yy"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"register_date",children:"Tanggal Kembali *"}),e.jsx(L,{value:t.return_date?new Date(t.return_date):null,style:{height:"35px"},onChange:a=>{new Date(a.target.value).toISOString().split("T")[0],i("return_date",a.target.value)},onFocus:()=>{l(u)},onShow:()=>{l(u)},onHide:()=>{c(u)},showIcon:!0,dateFormat:"dd/mm/yy"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"transportation",children:"Kendaraan *"}),e.jsx(d,{value:t.transportation,onChange:a=>i("transportation",a.target.value),onFocus:()=>{l(v)},onBlur:()=>{c(v)},className:"dark:bg-gray-300",id:"transportation","aria-describedby":"transportation-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"accomodation",children:"Akomodasi *"}),e.jsx(d,{value:t.accommodation,onChange:a=>i("accommodation",a.target.value),onFocus:()=>{l(b)},onBlur:()=>{c(b)},className:"dark:bg-gray-300",id:"accommodation","aria-describedby":"accommodation-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"signature",children:"Tanda Tangan *"}),e.jsx(S,{dataKey:"name",value:t.signature,onChange:a=>{i({...t,signature:{name:a.target.value.name,image:a.target.value.image,position:a.target.value.position}})},options:H,optionLabel:"name",placeholder:"Pilih Tanda Tangan",filter:!0,valueTemplate:N,itemTemplate:oe,className:"w-full md:w-14rem"})]}),e.jsx("div",{className:"flex-flex-col mt-3",children:e.jsx("form",{onSubmit:ue,children:e.jsx(w,{className:"mx-auto justify-center block",children:"Submit"})})})]})]})}),e.jsx(we,{header:"Karyawan",visible:U,style:{width:"75vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>p(!1),footer:ie,children:e.jsxs(Ne,{value:J,paginator:!0,filters:y,rows:5,header:ce,scrollable:!0,scrollHeight:"flex",tableStyle:{minWidth:"50rem"},selectionMode:z?null:"checkbox",selection:t.employees,onSelectionChange:a=>{i("employees",a.value)},dataKey:"name",children:[e.jsx(k,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(k,{field:"name",header:"Name"}),e.jsx(k,{filter:!0,body:a=>e.jsx("span",{children:a.position}),header:"Jabatan",field:"position"})]})}),e.jsxs("div",{className:"md:w-[65%] hidden md:block h-screen text-sm max-h-screen overflow-y-auto p-5",children:[e.jsx("header",{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"w-full",children:e.jsx("img",{src:"/assets/img/cazh.png",alt:"",className:"float-left w-1/3 h-1/3"})}),e.jsxs("div",{className:"w-full text-right text-xs",children:[e.jsx("h2",{className:"font-bold",children:"PT CAZH TEKNOLOGI INOVASI"}),e.jsx("p",{children:"Bonavida Park D1, Jl. Raya Karanggintung"}),e.jsx("p",{children:"Kec. Sumbang, Kab. Banyumas,Jawa Tengah 53183"}),e.jsx("p",{children:"hello@cards.co.id | https://cards.co.id"})]})]})}),e.jsxs("div",{className:"text-center mt-5",children:[e.jsx("h1",{className:"font-bold underline mx-auto",children:"SURAT TUGAS PERJALANAN DINAS"}),e.jsxs("p",{className:"",children:["Nomor : ",t.code]})]}),e.jsx("div",{className:"w-full mt-5",children:e.jsxs("table",{className:"w-full",children:[e.jsxs("thead",{className:"bg-blue-100 dark:text-gray-600 text-left",children:[e.jsx("th",{className:"px-2 py-1",children:"No"}),e.jsx("th",{className:"px-2 py-1",children:"Nama Karyawan"}),e.jsx("th",{className:"px-2 py-1",children:"Jabatan"})]}),e.jsxs("tbody",{children:[((A=t.employees)==null?void 0:A.length)==0&&e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:3,children:"Karyawan belum ditambah"})}),(I=t.employees)==null?void 0:I.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-1",children:++n}),e.jsx("td",{className:"px-2 py-1",children:a.name}),e.jsx("td",{className:"px-2 py-1",children:a.position})]},a.name+n))]})]})}),e.jsx("p",{className:"mt-10",children:"Untuk melaksanakan tugas melakukan perjalanan dinas dengan ketentuan sebagai berikut:"}),e.jsx("div",{className:"w-full mt-5",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Lembaga Tujuan"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsx("td",{className:"text-gray-700 font-bold w-7/12",children:t.partner.name??"{{Lembaga}}"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Lokasi"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsxs("td",{className:"text-gray-700 font-bold w-7/12",children:[e.jsx("span",{ref:x,children:t.partner.regency?Ke(JSON.parse(t.partner.regency).name):"{{Kab/Kota}}"}),", ",e.jsx("span",{ref:h,children:t.partner.province?JSON.parse(t.partner.province).name:"{{Provinsi}}"})]})]}),e.jsx("br",{}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Berangkat"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsx("td",{ref:m,className:"text-gray-700 font-bold w-7/12",children:P(t.departure_date)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Kembali"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsx("td",{ref:u,className:"text-gray-700 font-bold w-7/12",children:P(t.return_date)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Kendaraan"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsx("td",{ref:v,className:"text-gray-700 font-bold w-7/12",children:t.transportation??"{{Kendaraan}}"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-gray-700 w-1/6",children:"Akomodasi"}),e.jsx("td",{className:"text-gray-700 w-[1%]",children:":"}),e.jsx("td",{ref:b,className:"text-gray-700 font-bold w-7/12",children:t.accommodation??"{{Akomodasi}}"})]})]})})}),e.jsx("div",{className:"w-full mt-5 text-justify",children:"Semua biaya dalam perjalanan dinas, konsumsi, serta akomodasi dalam rangka perjalanan dinas ini akan menjadi tanggung jawab PT Cazh Teknologi Inovasi sesuai peraturan perjalanan dinas yang berlaku."}),e.jsx("div",{className:"w-full mt-5 text-justify",children:"Demikian surat ini dibuat agar dapat dilaksanakan dengan baik dan penuh tanggung jawab. Kepada semua pihak yang terlibat dimohon kerja sama yang baik agar perjalanan dinas ini dapat terlaksana dengan lancar."}),e.jsxs("div",{className:"flex flex-col mt-5 justify-start w-[30%]",children:[e.jsxs("p",{children:["Purwokerto, ",new Date().getFullYear()]}),e.jsx("div",{className:"h-[100px] w-[170px] py-2",children:e.jsx("img",{src:"/storage/"+t.signature.image,alt:"",className:"w-full h-full object-fill"})}),e.jsx("p",{children:t.signature.name}),e.jsx("p",{children:t.signature.position})]})]})]})})}),e.jsx(Ce,{dialogInstitutionVisible:q,setDialogInstitutionVisible:T,filters:y,setFilters:K,isLoadingData:Z,setIsLoadingData:Q,leads:X,setLeads:ee,partners:V,setPartners:M,data:t,setData:i,setProvinceName:j,reset:le})]})};export{xa as default};
