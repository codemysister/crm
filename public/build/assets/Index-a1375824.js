import{r as l,F as Ee,W as G,j as e,R as Q}from"./app-183ca207.js";import{D as Y,C as i}from"./column.esm-1f1d87c0.js";import{B as o}from"./button.esm-d3cd2157.js";import{D as Pe}from"./DashboardLayout-217cf030.js";import{I as f}from"./inputtext.esm-0c7f541c.js";import{C as Z,c as ee}from"./confirmdialog.esm-3c4cbf5c.js";import{T as Ie,a as T}from"./tabview.esm-5482a716.js";import{S as Te}from"./SkeletonDatatable-07c9c4e2.js";import{H as ze}from"./HeaderDatatable-497e5508.js";import{M as S}from"./Modal-50696ec9.js";import{T as Me}from"./toast.esm-b97f2233.js";import{I as d}from"./InputError-6be719bf.js";import{H as Re}from"./HeaderModule-b06ca799.js";import{O as Ae}from"./overlaypanel.esm-9c3ae74e.js";import{g as Le}from"./getViewportSize-e6da2c0c.js";import{r as _e,p as Ue,F as y}from"./filepond.min-8386e795.js";import{f as Be}from"./formatDate-5c964a42.js";import{R as He}from"./index-d8f5d992.js";import{L as Je,A as Ke}from"./ArsipComponent-6d496fd7.js";import"./ripple.esm-4b355069.js";import"./inputnumber.esm-6c4b14f0.js";import"./dropdown.esm-0caba294.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./portal.esm-545bb246.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-80aa95ee.js";import"./Dropdown-b69220a2.js";import"./dialog.esm-202fdef4.js";import"./index.esm-d51fec0e.js";import"./skeleton.esm-b303042b.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./index-387d7a00.js";import"./badge.esm-c550247d.js";import"./calendar.esm-fe4692a5.js";import"./message.esm-4bbe4c64.js";import"./sidebar.esm-1f854c9b.js";import"./PermissionErrorDialog-eff24ba6.js";_e(Ue);const Ba=({auth:j,usersProp:ae})=>{const[h,F]=l.useState(0),[se,le]=l.useState(null),[z,Oe]=l.useState(ae),[te,M]=l.useState(!1),[R,re]=l.useState(null),[ie,V]=l.useState(!1),C=l.useRef(null),A=l.useRef(null),b=Le().width<992,[oe,de]=l.useState(!0),[ne,D]=l.useState(!1),[ce,E]=l.useState(!1),[me,P]=l.useState(!1),[pe,I]=l.useState(!1),{roles:qe,permissions:w}=j.user,[L,ue]=l.useState({global:{value:null,matchMode:Ee.CONTAINS}}),[he,be]=l.useState(null),{data:t,setData:r,post:_,put:We,patch:Xe,delete:xe,reset:v,processing:U,errors:x,clearErrors:B}=G({id:null,uuid:null,title:null,description:null,thumbnail:null}),{data:g,setData:n,post:H,put:Ge,patch:Qe,delete:Ye,reset:k,processing:J,errors:N,clearErrors:Ze}=G({id:null,uuid:null,playlist_id:null,title:null,video:null});l.useState(""),l.useEffect(()=>{h==0&&K(c)},[h]);const c=async()=>{V(!0);let s=await(await fetch("/api/playlists")).json();le(u=>s),V(!1)},K=async a=>{try{await Promise.all([a()]),V(!1),de(s=>s=!1)}catch(s){console.error("Error fetching data:",s)}};l.useEffect(()=>{K(c)},[]);const O=()=>e.jsx("i",{className:"pi pi-plus",style:{fontSize:"0.7rem",paddingRight:"5px"}}),ge=a=>e.jsx(Q.Fragment,{children:e.jsx("i",{className:"pi pi-ellipsis-h pointer cursor-pointer",onClick:s=>{re(a),A.current.toggle(s)}})}),fe=a=>{r({...t,uuid:a.uuid,title:a.title,description:a.description,thumbnail:a.thumbnail}),B(),E(!0)},ye=()=>{xe("playlists/"+R.uuid,{onSuccess:()=>{c(),m("Hapus"),v()},onError:()=>{p("Hapus")}})},je=()=>{ee({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:()=>{M(!0)}})},we=()=>e.jsx(ze,{filters:L,setFilters:ue}),m=a=>{C.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},p=a=>{C.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},$=(a,s)=>{a.preventDefault(),s==="tambah"?_("/playlists",{onSuccess:()=>{m("Tambah"),D(u=>!1),c(),v(),F(u=>0)},onError:()=>{p("Tambah")}}):_("/playlists/"+t.uuid,{onSuccess:()=>{m("Update"),E(u=>!1),c(),v()},onError:()=>{p("Update")}})},q=(a,s)=>{a.preventDefault(),s==="tambah"?H("/videos",{onSuccess:()=>{m("Tambah"),P(u=>!1),c(),k("title","video"),F(u=>0)},onError:()=>{p("Tambah")}}):H("/videos/"+g.uuid,{onSuccess:()=>{m("Update"),I(u=>!1),c(),k("title","video")},onError:()=>{p("Update")}})},W=[{field:"title",header:"Judul",frozen:!b,style:b?null:{width:"max-content",whiteSpace:"nowrap"}},{field:"slug",header:"Slug",frozen:!b,style:b?null:{width:"max-content",whiteSpace:"nowrap"}},{field:"thumbnail",header:"Thumbnail",frozen:!b,style:b?null:{width:"max-content",whiteSpace:"nowrap"},body:a=>e.jsx("div",{className:"w-full h-[100px] bg-no-repeat bg-cover rounded-t-xl",style:{backgroundImage:`url(${a.thumbnail})`,backgroundPosition:"center",backgroundSize:"cover"}})}],ve=a=>a.videos.length>=0,ke=e.jsx("div",{className:"flex flex-row gap-2 bg-gray-50 dark:bg-transparent p-2 rounded-lg align-items-center items-center justify-between justify-content-between",children:e.jsx("div",{className:"w-[30%]",children:w.includes("tambah video")&&e.jsx(o,{label:"Input Video",className:"bg-purple-600 w-[100px] max-w-[100px] text-xs shadow-md rounded-lg mr-2",icon:O,onClick:()=>{P(a=>!0),k("title","video")},"aria-controls":"popup_menu_right","aria-haspopup":!0})})}),Ne=a=>{n({...t,uuid:a.uuid,title:a.title,video:a.video})},Se=a=>{ee({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:async()=>{axios.delete("videos/"+a.uuid,{headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}).then(s=>{s.data.error?p(s.data.error):(m("Tambah"),c(),k())})}})},Fe=a=>e.jsxs(Q.Fragment,{children:[w.includes("edit transaksi")&&e.jsx(o,{icon:"pi pi-pencil",rounded:!0,outlined:!0,className:"mr-2",onClick:()=>{I(!0),Ne(a)}}),w.includes("hapus transaksi")&&e.jsx(o,{icon:"pi pi-trash",rounded:!0,outlined:!0,severity:"danger",onClick:()=>{Se(a)}})]}),Ve=a=>{let s;return a=="title"?s="Judul":a=="description"?s="Deskripsi Singkat":a=="playlist.title"&&(s="Playlist"),s},Ce=a=>e.jsx("div",{className:"md:px-14",children:e.jsx("div",{className:"flex",children:e.jsxs(Y,{headerClassName:"bg-red-500",value:a.videos,className:"",header:ke,emptyMessage:"Video belum ditambahkan.",children:[e.jsx(i,{header:"No",body:(s,{rowIndex:u})=>u+1,className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300",style:{width:"max-content",whiteSpace:"nowrap"}}),e.jsx(i,{field:"title",header:"Judul",style:{width:"max-content",whiteSpace:"nowrap"},headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{field:"video",header:"Video",style:{width:"max-content",whiteSpace:"nowrap"},body:s=>e.jsx(He,{width:"100%",height:"100px",playIcon:null,playing:!1,controls:!0,url:s.video}),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{field:"created_by",header:"Diinput Oleh",style:{width:"max-content",whiteSpace:"nowrap"},body:s=>s.created_by.name,headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(i,{header:"Action",body:Fe,style:{width:"max-content",whiteSpace:"nowrap"},className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"})]})})}),X=["title"],De=a=>{n(s=>({...s,playlist_id:a.data.id,title:a.data.title}))};return oe?e.jsx(Te,{auth:j}):e.jsxs(Pe,{auth:j.user,className:"",children:[e.jsx(Ae,{className:" shadow-md p-1 dark:bg-slate-900 dark:text-gray-300",ref:A,children:e.jsxs("div",{className:"flex flex-col flex-wrap w-full",children:[e.jsx(o,{icon:"pi pi-pencil",label:"edit",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{fe(R)}}),e.jsx(o,{icon:"pi pi-trash",label:"hapus",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{je()}})]})}),e.jsx(Re,{title:"Playlist",children:w.includes("tambah video")&&e.jsx(o,{label:"Tambah",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2",icon:O,onClick:()=>{D(a=>!0),v(),B()},"aria-controls":"popup_menu_right","aria-haspopup":!0})}),e.jsx(Me,{ref:C}),e.jsxs(Ie,{activeIndex:h,onTabChange:a=>{F(a.index)},className:"mt-2",children:[e.jsx(T,{header:"Semua Playlist",children:h==0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(Z,{group:"declarative",visible:te,onHide:()=>M(!1),message:"Konfirmasi kembali jika anda yakin!",header:"Konfirmasi kembali",icon:"pi pi-info-circle",accept:ye}),e.jsx("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",children:e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(Y,{loading:ie,className:"w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:""},paginator:!0,rowsPerPageOptions:[5,10,25,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",filters:L,rows:10,emptyMessage:"Playlist tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:we,globalFilterFields:X,value:se,dataKey:"id",expandedRows:he,onRowToggle:a=>{be(a.data)},rowExpansionTemplate:Ce,onRowExpand:De,children:[e.jsx(i,{align:"center",expander:ve,style:{width:"fit-content",whiteSpace:"nowrap"},frozen:!0,headerClassName:"dark:border-none bg-white pl-6 dark:bg-slate-900 dark:text-gray-300"}),e.jsx(i,{header:"Aksi",body:ge,style:{width:"max-content",whiteSpace:"nowrap"},frozen:!0,align:"center",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}),W.map(a=>e.jsx(i,{field:a.field,header:a.header,body:a.body,style:a.style,frozen:a.frozen,align:"left",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"})),e.jsx(i,{field:"created_at",className:"dark:border-none bg-white lg:whitespace-nowrap lg:w-max",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300",header:"Tanggal Input",align:"left",body:a=>Be(a.created_at),style:{width:"max-content",whiteSpace:"nowrap"}}),e.jsx(i,{field:"created_by",className:"dark:border-none bg-white lg:whitespace-nowrap lg:w-max",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300",header:"Diinput Oleh",align:"left",body:a=>a.created_by.name,style:{width:"max-content",whiteSpace:"nowrap"}})]})})})]})}),e.jsx(T,{header:"Log",children:h==1&&e.jsx(Je,{auth:j,fetchUrl:"/api/playlists/logs",filterUrl:"/playlists/logs/filter",deleteUrl:"/playlists/logs",objectKeyToIndo:Ve,users:z,showSuccess:m,showError:p})}),e.jsx(T,{header:"Arsip",children:h==2&&e.jsx(Ke,{auth:j,users:z,fetchUrl:"/api/playlists/arsip",forceDeleteUrl:"/playlists/{id}/force",restoreUrl:"/playlists/{id}/restore",filterUrl:"/playlists/arsip/filter",columns:W,showSuccess:m,showError:p,globalFilterFields:X})})]}),e.jsx(S,{header:"Playlist",modalVisible:ne,setModalVisible:D,children:e.jsxs("form",{onSubmit:a=>$(a,"tambah"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Judul *"}),e.jsx(f,{value:t.title,onChange:a=>r("title",a.target.value),className:"dark:bg-gray-300",id:"title","aria-describedby":"title-help"}),e.jsx(d,{message:x.title,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Deskripsi Singkat *"}),e.jsx(f,{value:t.description,onChange:a=>r("description",a.target.value),className:"dark:bg-gray-300",id:"description","aria-describedby":"description-help"}),e.jsx(d,{message:x.description,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Thumbnail"}),e.jsx("div",{className:"App",children:e.jsx(y,{onaddfile:(a,s)=>{r("thumbnail",s.file)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",name:"files",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}),e.jsx(d,{message:x.thumbnail,className:"mt-2"})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(o,{label:"Submit",disabled:U,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})}),e.jsx(S,{header:"Edit Playlist",modalVisible:ce,setModalVisible:E,children:e.jsxs("form",{onSubmit:a=>$(a,"update"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Judul *"}),e.jsx(f,{value:t.title,onChange:a=>r("title",a.target.value),className:"dark:bg-gray-300",id:"title","aria-describedby":"title-help"}),e.jsx(d,{message:x.title,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Deskripsi Singkat *"}),e.jsx(f,{value:t.description,onChange:a=>r("description",a.target.value),className:"dark:bg-gray-300",id:"description","aria-describedby":"description-help"}),e.jsx(d,{message:x.description,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Thumbnail"}),e.jsx("div",{className:"App",children:t.thumbnail!==null&&typeof t.thumbnail=="string"?e.jsx(e.Fragment,{children:e.jsx(y,{files:t.thumbnail,onaddfile:(a,s)=>{a||r("thumbnail",s.file)},onremovefile:()=>{r("thumbnail",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(y,{onaddfile:(a,s)=>{a||r("thumbnail",s.file)},onremovefile:()=>{r("thumbnail",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})}),e.jsx(d,{message:x.thumbnail,className:"mt-2"})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(o,{label:"Submit",disabled:U,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})}),e.jsx(S,{header:"Video",modalVisible:me,setModalVisible:P,children:e.jsxs("form",{onSubmit:a=>q(a,"tambah"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Judul *"}),e.jsx(f,{value:g.title,onChange:a=>n("title",a.target.value),className:"dark:bg-gray-300",id:"title","aria-describedby":"title-help"}),e.jsx(d,{message:N.title,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Video"}),e.jsx("div",{className:"App",children:e.jsx(y,{onaddfile:(a,s)=>{n("video",s.file)},maxFileSize:"500mb",labelMaxFileSizeExceeded:"File terlalu besar",name:"files",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}),e.jsx(d,{message:N.video,className:"mt-2"})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(o,{label:"Submit",disabled:J,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})}),e.jsx(S,{header:"Video",modalVisible:pe,setModalVisible:I,children:e.jsxs("form",{onSubmit:a=>q(a,"update"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"title",children:"Judul *"}),e.jsx(f,{value:g.title,onChange:a=>n("title",a.target.value),className:"dark:bg-gray-300",id:"title","aria-describedby":"title-help"}),e.jsx(d,{message:N.title,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Video"}),e.jsx("div",{className:"App",children:g.video!==null&&typeof g.video=="string"?e.jsx(e.Fragment,{children:e.jsx(y,{files:g.video,onaddfile:(a,s)=>{a||n("video",s.file)},onremovefile:()=>{n("video",null)},maxFileSize:"500mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(y,{onaddfile:(a,s)=>{a||n("video",s.file)},onremovefile:()=>{n("video",null)},maxFileSize:"500mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})}),e.jsx(d,{message:N.video,className:"mt-2"})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(o,{label:"Submit",disabled:J,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})]})};export{Ba as default};
