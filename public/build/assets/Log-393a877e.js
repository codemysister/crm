import{r as s,F as P,j as r}from"./app-183ca207.js";import{H as C}from"./HeaderDatatable-497e5508.js";import{S as F}from"./SkeletonDatatable-07c9c4e2.js";import{B as R}from"./badge.esm-c550247d.js";import{B as O}from"./button.esm-d3cd2157.js";import{D as M,C as o}from"./column.esm-1f1d87c0.js";import{M as i}from"./message.esm-4bbe4c64.js";import{O as B}from"./overlaypanel.esm-9c3ae74e.js";import"./ripple.esm-4b355069.js";import"./inputtext.esm-0c7f541c.js";import"./DashboardLayout-217cf030.js";import"./Dropdown-b69220a2.js";import"./skeleton.esm-b303042b.js";import"./portal.esm-545bb246.js";import"./inputnumber.esm-6c4b14f0.js";import"./dropdown.esm-0caba294.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-80aa95ee.js";import"./index.esm-c27cbd20.js";const E=({auth:m,showSuccess:T,showError:I})=>{const[g,d]=s.useState(!1),[e,x]=s.useState(null),[f,b]=s.useState(!0),[p,h]=s.useState(null),c=s.useRef(),[u,v]=s.useState({global:{value:null,matchMode:P.CONTAINS}}),[j,w]=s.useState(""),N=t=>{const l=t.target.value;let a={...u};a.global.value=l,v(a),w(l)},k=async()=>{d(!0);let l=await(await fetch("/api/status/log")).json();h(a=>l),d(!1)};s.useEffect(()=>{(async()=>{b(l=>!1),await k()})()},[]);const y=()=>r.jsx(C,{globalFilterValue:j,onGlobalFilterChange:N});return f?r.jsx(F,{auth:m}):r.jsxs("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",children:[r.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:r.jsxs(M,{id:"tablelog",loading:g,className:"table-log w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:""},paginator:!0,rowsPerPageOptions:[5,10,25,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",rows:10,filters:u,emptyMessage:"Status tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:y,globalFilterFields:["name","category","causer.name"],value:p,dataKey:"id",children:[r.jsx(o,{field:"causer",hidden:!0,className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",align:"left",style:{width:"max-content",whiteSpace:"nowrap"},body:t=>t.causer.name}),r.jsx(o,{field:"uuid",hidden:!0,className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",align:"left",style:{width:"max-content",whiteSpace:"nowrap"}}),console.log(p),r.jsx(o,{className:"dark:border-none",headerClassName:"dark:border-none bg-transparent dark:bg-transparent dark:text-gray-300",header:"Aktivitas",align:"left",style:{width:"max-content",whiteSpace:"nowrap"},body:t=>{let l=t.causer?t.causer.name:"",a="",n="";return t.event=="created"?(a="tambah",n="success"):t.event=="restored"?(a="pulihkan",n="success"):t.event=="deleted"?(a="hapus",n="error"):t.event=="updated"&&(a="edit",n="info"),r.jsxs("div",{className:"flex justify-between w-full",children:[r.jsxs("div",{className:"flex gap-4",children:[r.jsx(R,{value:a,severity:n=="error"?"danger":n,className:"w-20"}),r.jsx("p",{children:l+" "+t.description})]}),r.jsx("div",{children:r.jsx(O,{label:"detail",className:"p-0 underline bg-transparent text-blue-700 text-left",onClick:L=>{c.current.toggle(L),x(_=>({properties:t.properties,event:t.event}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]})}})]})}),r.jsx(B,{className:"w-[40%] md:max-w-[50%] dark:bg-slate-900 dark:text-gray-300",ref:c,showCloseIcon:!0,children:r.jsxs("div",{className:"flex flex-wrap gap-2",children:[(e==null?void 0:e.event)=="created"||(e==null?void 0:e.event)=="updated"||(e==null?void 0:e.event)=="restored"?r.jsx("div",{className:"flex-1 w-1/2",children:r.jsx(i,{className:"bg-green-300 text-green-800 rounded-md w-full",severity:"success",content:r.jsx("div",{className:"flex justify-between w-full",children:r.jsxs("div",{className:"flex flex-col gap-2",children:[((e==null?void 0:e.event)==="created"||(e==null?void 0:e.event)==="restored")&&e!==null?Object.keys(e.properties.attributes).map(t=>r.jsxs("p",{children:[t," :"," ",e.properties.attributes[t]]})):null,(e==null?void 0:e.event)=="updated"&&(e!==null?Object.keys(e.properties.attributes).map(t=>e.properties.attributes[t]!==e.properties.old[t]&&r.jsxs("p",{children:[t," :"," ",e.properties.attributes[t]]})):null)]})})})}):null,(e==null?void 0:e.event)=="updated"?r.jsx("div",{className:"flex-1 w-1/2",children:r.jsx(i,{className:"bg-red-300 text-red-800 rounded-md w-full",severity:"success",content:r.jsx("div",{className:"flex justify-between w-full",children:r.jsx("div",{className:"flex flex-col gap-2",children:e!==null?Object.keys(e.properties.old).map(t=>e.properties.attributes[t]!==e.properties.old[t]&&r.jsxs("p",{children:[t," :"," ",e.properties.old[t]]})):null})})})}):null,(e==null?void 0:e.event)=="deleted"?r.jsx("div",{className:"flex-1 ",children:r.jsx(i,{className:"bg-red-300 text-red-800 rounded-md w-full",severity:"success",content:r.jsx("div",{className:"flex justify-between w-full",children:r.jsx("div",{className:"flex flex-col gap-2",children:Object.keys(e.properties.old).map(t=>r.jsxs("p",{children:[t," :"," ",e.properties.old[t]]}))})})})}):null]})})]})},ne=E;export{ne as default};
