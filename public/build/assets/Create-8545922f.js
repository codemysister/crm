import{r as l,q as we,W as Se,F as Pe,j as e,a as Re,d as Ce,y as De}from"./app-183ca207.js";import{I as u}from"./inputtext.esm-0c7f541c.js";import{C as Fe}from"./card.esm-aad9a2fd.js";import{B as h}from"./button.esm-d3cd2157.js";import{D as Ie,C as p}from"./column.esm-1f1d87c0.js";import{D as W}from"./dialog.esm-202fdef4.js";import{D as I}from"./dropdown.esm-0caba294.js";import{T as Te}from"./toast.esm-b97f2233.js";import{B as Le}from"./badge.esm-c550247d.js";import{I as T}from"./inputnumber.esm-6c4b14f0.js";import{I as o}from"./InputError-6be719bf.js";import{H as _e}from"./HeaderDatatable-497e5508.js";import{a as Ee,g as Be}from"./getProvince-aa058a1f.js";import{u as z}from"./UppercaseEachWord-e9d7052e.js";import{D as Ae}from"./DialogInstitution-405a9aff.js";import{B as He,L as Ke}from"./blockui.esm-74c21695.js";import"./ripple.esm-4b355069.js";import"./portal.esm-545bb246.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./formatNPWP-cf5b7efc.js";import"./progressspinner.esm-5c964cda.js";const ba=({usersProp:U,partnersProp:$,salesProp:G,productsProp:Y,signaturesProp:Z})=>{var J,V,q;l.useState(U);const[X,Q]=l.useState($),[ee,ae]=l.useState(null),[se,Oe]=l.useState(G),[le,re]=l.useState(!1);l.useState(Z);const[te,Me]=l.useState(Y),[ne,v]=l.useState(!1),[ie,b]=l.useState(!1),[ce,L]=l.useState(!1),[oe,Je]=l.useState(!0),[_,E]=l.useState([]),N=l.useRef(null),de=l.useRef(null),[me,ue]=l.useState([]),[he,pe]=l.useState([]),[y,B]=l.useState(null),[A,Ve]=l.useState(localStorage.theme),[xe,H]=l.useState(!1);we().props.auth.user,l.useEffect(()=>{A?localStorage.theme="dark":localStorage.removeItem("theme"),localStorage.theme==="dark"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[A]);const k=l.useRef(null),w=l.useRef(null),x=l.useRef(null),f=l.useRef(null),g=l.useRef(null),S=l.useRef(null),P=l.useRef(null),fe=l.useRef(null),{data:s,setData:n,post:ge,put:qe,delete:We,reset:je,processing:K,errors:c}=Se({uuid:"",code:`${Math.floor(Math.random()*1e3)}/CAZH-SPH/X/${new Date().getFullYear()}`,products:[],partner:{id:null,name:null,province:null,regency:null,pic:null},sales:{id:null,name:null,email:null,address:null,wa:null},created_by:null,signature:{name:"Muh Arif Mahmudin",position:"CEO",image:"/assets/img/signatures/ttd.png"}});l.useEffect(()=>{(async()=>{let r=await Ee();ue(m=>r)})()},[]),l.useEffect(()=>{H(!!K)},[K]),l.useEffect(()=>{(async()=>{if(y){let r=await Be(y);pe(m=>r)}})()},[y]);const[R,O]=l.useState({global:{value:null,matchMode:Pe.CONTAINS}});document.querySelector("body").classList.add("overflow-hidden");const M=a=>e.jsx(h,{label:"OK",icon:"pi pi-check",onClick:()=>a!="product"?v(!1):ve()}),ve=()=>{const r=_.filter(t=>!s.products.includes(t)).map(t=>({...t,qty:1,total:1*t.price})),m=[...s.products,...r];n("products",m),b(!1),E(t=>[])},i=a=>(a.current&&(a.current.classList.add("twinkle"),a.current.focus()),null),d=a=>(a.current.classList.remove("twinkle"),null),C=(a,r)=>a?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}):e.jsx("span",{children:r.placeholder}),D=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),be=()=>e.jsx(_e,{filters:R,setFilters:O}),Ne=a=>{N.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},ye=a=>{N.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},j=(a,r,m)=>{const t=[...s.products];if(t[a][r]=m,r=="price"||r=="qty"){let F=t[a].price*t[a].qty;t[a].total=F}n("products",t)},ke=a=>{a.preventDefault(),ge("/sph",{onSuccess:()=>{Ne("Tambah"),De.get("/sph")},onError:()=>{ye("Tambah")}})};return e.jsxs(e.Fragment,{children:[e.jsx(Re,{title:"Surat Penawaran Harga"}),e.jsx(Te,{ref:N}),e.jsx(He,{blocked:xe,template:Ke,children:e.jsx("div",{className:"h-screen max-h-screen overflow-y-hidden",children:e.jsxs("div",{className:"flex flex-col h-screen max-h-screen overflow-hidden md:flex-row z-40 relative gap-5",children:[e.jsx("div",{className:"md:w-[35%] overflow-y-auto h-screen max-h-screen p-5",children:e.jsxs(Fe,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Surat Penawaran Harga"}),e.jsx(Ce,{href:"/sph",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"})})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(h,{label:"Tambah Produk",icon:"pi pi-external-link",onClick:()=>v(!0)}),e.jsx(o,{message:c.products,className:"mt-2"}),e.jsx("div",{className:"flex flex-col mt-3",children:e.jsx(u,{value:s.code,onChange:a=>n("code",a.target.value),className:"dark:bg-gray-300",id:"code","aria-describedby":"code-help",hidden:!0})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"lembaga",children:"Lembaga *"}),e.jsx(u,{value:s.partner.name,onFocus:()=>{i(k)},onBlur:()=>{d(k)},onClick:()=>{L(!0)},placeholder:"Pilih lembaga",className:"dark:bg-gray-300 cursor-pointer",id:"partner","aria-describedby":"partner-help"}),e.jsx(o,{message:c["partner.name"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_pic",children:"PIC *"}),e.jsx(u,{value:s.partner.pic,onChange:a=>n("partner",{...s.partner,pic:a.target.value}),onFocus:()=>{i(w)},onBlur:()=>{d(w)},className:"dark:bg-gray-300",id:"partner_pic","aria-describedby":"partner_pic-help"}),e.jsx(o,{message:c["partner.pic"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"province",children:"Provinsi *"}),e.jsx(I,{value:s.partner.province?JSON.parse(s.partner.province):null,onChange:a=>{B(r=>a.target.value.name),n("partner",{...s.partner,province:JSON.stringify(a.target.value),regency:null})},dataKey:"code",options:me,optionLabel:"name",placeholder:"Pilih Provinsi",filter:!0,valueTemplate:C,itemTemplate:D,className:"w-full md:w-14rem",onFocus:()=>{i(x)},onShow:()=>{i(x)},onBlur:()=>{d(x)}}),e.jsx(o,{message:c["partner.province"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"regency",children:"Kabupaten *"}),e.jsx(I,{dataKey:"code",value:s.partner.regency?JSON.parse(s.partner.regency):null,onChange:a=>{n("partner",{...s.partner,regency:JSON.stringify(a.target.value)})},onFocus:()=>{i(f)},onShow:()=>{i(f)},onBlur:()=>{d(f)},options:he,optionLabel:"name",placeholder:"Pilih Kabupaten",filter:!0,valueTemplate:C,itemTemplate:D,className:"w-full md:w-14rem"}),e.jsx(o,{message:c["partner.regency"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales",children:"Sales *"}),e.jsx(I,{value:s.sales,onChange:a=>{n("sales",{...s.sales,name:a.target.value.name,wa:a.target.value.number,email:a.target.value.email})},dataKey:"name",options:se,optionLabel:"name",placeholder:"Pilih Sales",filter:!0,valueTemplate:C,itemTemplate:D,className:"w-full md:w-14rem",onFocus:()=>{i(g)},onShow:()=>{i(g)},onBlur:()=>{d(g)}}),e.jsx(o,{message:c["sales.name"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales-whatsapp",children:"Whatsapp Sales *"}),e.jsx(u,{value:s.sales.wa,onChange:a=>{n("sales",{...s.sales,wa:a.target.value})},keyfilter:"int",className:"dark:bg-gray-300",id:"sales-whatsapp","aria-describedby":"sales-whatsapp-help",onFocus:()=>{i(S)},onBlur:()=>{d(S)}}),e.jsx(o,{message:c["sales.wa"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales-email",children:"Email Sales *"}),e.jsx(u,{value:s.sales.email,onChange:a=>n("sales",{...s.sales,email:a.target.value}),className:"dark:bg-gray-300",id:"sales-email","aria-describedby":"sales-email-help",onFocus:()=>{i(P)},onBlur:()=>{d(P)}}),e.jsx(o,{message:c["sales.email"],className:"mt-2"})]}),e.jsx("div",{className:"flex-flex-col mt-3",children:e.jsx("form",{onSubmit:ke,children:e.jsx(h,{className:"mx-auto justify-center block",children:"Submit"})})})]})]})}),e.jsxs(W,{header:"Input Produk",visible:ne,style:{width:"85vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>v(!1),footer:M,children:[e.jsxs("div",{className:"flex my-5 gap-3",children:[e.jsx(h,{label:"Pilih Produk",icon:"pi pi-external-link",onClick:()=>b(!0),className:"text-xs md:text-base"}),e.jsx(h,{label:"Tambah Produk",icon:"pi pi-plus",className:"text-xs md:text-base",onClick:()=>{let a={name:"",price:"",qty:"",detail:null,total:""},r=[...s.products,a];n("products",r)}})]}),(J=s.products)==null?void 0:J.map((a,r)=>{const m=r+1;return e.jsxs("div",{className:"flex gap-5 mt-2 items-center",children:[e.jsx("div",{children:e.jsx(Le,{value:m,size:"large"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Produk/Layanan *"}),e.jsx(u,{value:a.name,onChange:t=>j(r,"name",t.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Harga *"}),e.jsx(T,{value:a.price,onChange:t=>j(r,"price",t.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",locale:"id-ID"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Kuantitas *"}),e.jsx(T,{value:a.qty,onChange:t=>j(r,"qty",t.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",keyfilter:"int",locale:"id-ID"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Rincian *"}),e.jsx(u,{value:a.detail,onChange:t=>j(r,"detail",t.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Jumlah *"}),e.jsx(T,{value:a.total,className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",locale:"id-ID",disabled:!0})]})}),e.jsx("div",{className:"flex self-center pt-4 ",children:e.jsx(h,{className:"bg-red-500 h-1 w-1 shadow-md rounded-full ",icon:()=>e.jsx("i",{className:"pi pi-minus",style:{fontSize:"0.7rem"}}),onClick:()=>{const t=[...s.products];t.splice(r,1),n(F=>({...F,products:t}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]},a+r)}),e.jsx(W,{header:"Produk",visible:ie,style:{width:"75vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>b(!1),footer:()=>M("product"),children:e.jsxs(Ie,{value:te,paginator:!0,filters:R,rows:10,header:be,scrollable:!0,scrollHeight:"flex",tableStyle:{minWidth:"50rem"},selectionMode:oe?null:"checkbox",rowsPerPageOptions:[10,25,50,100],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",selection:_,onSelectionChange:a=>E(a.value),dataKey:"id",children:[e.jsx(p,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(p,{field:"name",header:"Nama"}),e.jsx(p,{field:"description",header:"Deskripsi"}),e.jsx(p,{field:"category",header:"Kategori"}),e.jsx(p,{field:"price",header:"Harga"})]})})]}),e.jsx(Ae,{dialogInstitutionVisible:ce,setDialogInstitutionVisible:L,filters:R,setFilters:O,isLoadingData:le,setIsLoadingData:re,leads:ee,setLeads:ae,partners:X,setPartners:Q,data:s,setData:n,reset:je,setProvinceName:B}),e.jsxs("div",{className:"md:w-[65%] hidden md:block text-sm h-screen max-h-screen overflow-y-auto p-5",children:[e.jsx("header",{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"w-full",children:e.jsx("img",{src:"/assets/img/cazh.png",alt:"",className:"float-left w-1/3 h-1/3"})}),e.jsxs("div",{className:"w-full text-right text-xs",children:[e.jsx("h2",{className:"font-bold",children:"PT CAZH TEKNOLOGI INOVASI"}),e.jsx("p",{children:"Bonavida Park D1, Jl. Raya Karanggintung"}),e.jsx("p",{children:"Kec. Sumbang, Kab. Banyumas,Jawa Tengah 53183"}),e.jsx("p",{children:"hello@cards.co.id | https://cards.co.id"})]})]})}),e.jsxs("div",{className:"text-center mt-5",children:[e.jsx("h1",{className:"font-bold underline mx-auto",children:"SURAT PENAWARAN HARGA"}),e.jsxs("p",{className:"",children:["Nomor : ",e.jsx("b",{children:s.code})]})]}),e.jsxs("div",{className:"mt-5",ref:de,children:[e.jsx("h1",{children:"Kepada Yth."}),e.jsx("h1",{className:"font-bold",ref:w,children:s.partner.pic??"{{pic}}"}),e.jsx("h1",{className:"font-bold",ref:k,children:s.partner.name??"{{partner}}"}),e.jsxs("h1",{children:["di"," ",e.jsx("span",{ref:f,children:s.partner.regency?z(JSON.parse(s.partner.regency).name):"{{alamat}}"}),", ",e.jsx("span",{ref:x,children:s.partner.province?z(JSON.parse(s.partner.province).name):"{{alamat}}"})]})]}),e.jsx("div",{className:"mt-5",children:e.jsx("h1",{children:"Dengan Hormat"})}),e.jsx("div",{className:"mt-5",children:e.jsxs("h1",{children:["Menindaklanjuti komunikasi yang telah dilakukan oleh tim marketing kami"," ",s.sales.name??"{{sales}}"," dengan perwakilan dari"," ",s.partner.name??"{{partner}}",", dengan ini kami sampaikan penawaran sebagai berikut:"]})}),e.jsx("div",{className:"w-full mt-5",children:e.jsxs("table",{className:"w-full",children:[e.jsxs("thead",{className:"bg-blue-100 dark:text-black text-left",children:[e.jsx("th",{className:"pl-2",children:"No"}),e.jsx("th",{className:"py-2",children:"Produk/Layanan"}),e.jsx("th",{className:"py-2",children:"Rincian"}),e.jsx("th",{className:"py-2 text-center",children:"Jumlah"})]}),e.jsxs("tbody",{children:[((V=s.products)==null?void 0:V.length)==0&&e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:4,children:"Produk belum ditambah"})}),(q=s.products)==null?void 0:q.map((a,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"pl-2",children:++r}),e.jsx("td",{children:a.name}),e.jsx("td",{children:a.detail}),e.jsxs("td",{className:"text-right px-4",children:["Rp",a.total?a.total.toLocaleString("id"):0]})]},a.name+r))]})]})}),e.jsx("div",{class:"mt-6",children:e.jsx("div",{class:"text-sm text-left w-full",children:"*) Harga yang tertera belum termasuk PPN sebesar 11%."})}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h1",{children:"Untuk konfirmasi persetujuan silakan hubungi :"}),e.jsxs("h1",{children:[e.jsx("b",{ref:g,children:s.sales.name??"{{sales}}"})," ","via WA :"," ",e.jsx("b",{ref:S,children:s.sales.wa??"{{wa_sales}}"}),", email :"," ",e.jsx("b",{ref:P,children:s.sales.email??"{{email_sales}}"})]})]}),e.jsx("div",{className:"mt-5",children:e.jsx("h1",{children:"Demikian surat penawaran harga ini kami sampaikan dengan sesungguhnya. Atas perhatian dan kerja sama yang baik, kami sampaikan terima kasih."})}),e.jsxs("div",{className:"flex flex-col mt-5 justify-start w-[30%]",ref:fe,children:[e.jsxs("p",{children:["Purwokerto,"," ",new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]}),e.jsx("div",{className:"h-[100px] w-[170px] self-start py-2",children:e.jsx("img",{src:s.signature.image,alt:"",className:"object-fill  w-full h-full"})}),e.jsx("p",{children:s.signature.name}),e.jsx("p",{children:s.signature.position})]})]})]})})})]})};export{ba as default};
