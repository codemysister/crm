import{r as l,F as N,j as e}from"./app-183ca207.js";import"./HeaderDatatable-497e5508.js";import{B as _}from"./badge.esm-c550247d.js";import{B as y}from"./button.esm-d3cd2157.js";import{D as P,C as o}from"./column.esm-1f1d87c0.js";import{M as d}from"./message.esm-4bbe4c64.js";import{O as S}from"./overlaypanel.esm-9c3ae74e.js";import{f as p}from"./formatDate-5c964a42.js";import"./ripple.esm-4b355069.js";import"./inputtext.esm-0c7f541c.js";import"./portal.esm-545bb246.js";import"./inputnumber.esm-6c4b14f0.js";import"./dropdown.esm-0caba294.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-80aa95ee.js";import"./index.esm-c27cbd20.js";const Z=({partner:m,handleSelectedDetailPartner:k,showSuccess:F,showError:C})=>{const[g,c]=l.useState(!1),[a,f]=l.useState(null),[x,h]=l.useState(null),u=l.useRef(),[b,O]=l.useState({global:{value:null,matchMode:N.CONTAINS}});l.useState("");const v=async()=>{c(!0);let i=await(await fetch("/api/partners/logs?partner="+m.id)).json();h(r=>i),c(!1)};l.useEffect(()=>{(async()=>{await v()})()},[]);const j={name:"Nama",npwp:"NPWP",password:"Password",status:"Status",phone_number:"Nomor Telepon",province:"Provinsi",regency:"Kabupaten",subdistrict:"Kecamatan",address:"Alamat",sales:"Sales",account_managers:"Account Manager",onboarding_date:"Tanggal Onboarding",live_date:"Tanggal Live",live_age:"Umur Live",onboarding_age:"Umur Onboarding",monitoring_date_after_3_month_live:"Tanggal Monitoring setelah 3 bulan live",period:"Periode Langganan"},n=t=>{const r=t.split(".")[0];return j[r]||r};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex mx-auto flex-col justify-center gap-5",children:[e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(P,{id:"tablelog",loading:g,className:"w-full h-full rounded-lg border-none text-center",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300 h-full",table:"dark:bg-transparent bg-white dark:text-gray-300 h-full",header:"",thead:"hidden"},style:{height:"300px"},showGridlines:!0,paginator:!0,filters:b,rowsPerPageOptions:[5,10,25,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",rows:10,emptyMessage:"Log tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-status-log dark:text-gray-300 rounded-b-lg",globalFilterFields:["name","category","causer.name"],value:x,dataKey:"id",children:[e.jsx(o,{field:"causer",hidden:!0,className:"border-none",headerClassName:"border-none bg-transparent dark:bg-transparent dark:text-gray-300",align:"left",style:{width:"max-content",whiteSpace:"nowrap"},body:t=>t.causer.name}),e.jsx(o,{field:"uuid",hidden:!0,className:"border-none",headerClassName:"border-none bg-transparent dark:bg-transparent dark:text-gray-300",align:"left",style:{width:"max-content",whiteSpace:"nowrap"}}),e.jsx(o,{className:"border-none",headerClassName:"border-none bg-transparent dark:bg-transparent dark:text-gray-300",align:"left",style:{width:"max-content",whiteSpace:"nowrap"},body:t=>{let i=t.causer?t.causer.name:"",r="",s="";return t.event=="created"?(r="tambah",s="success"):t.event=="restored"?(r="pulihkan",s="success"):t.event=="deleted"?(r="hapus",s="error"):t.event=="updated"&&(r="edit",s="info"),e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(_,{value:r,severity:s=="error"?"danger":s,className:"w-20"}),e.jsx("p",{children:p(t.created_at)+", "+i+" "+t.description})]}),e.jsx("div",{children:e.jsx(y,{label:"detail",className:"p-0 underline bg-transparent text-blue-700 text-left",onClick:w=>{u.current.toggle(w),f(T=>({properties:t.properties,event:t.event}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]})}})]})}),e.jsx(S,{className:"w-[40%] shadow-md md:max-w-[50%] dark:bg-slate-900 dark:text-gray-300",ref:u,showCloseIcon:!0,children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(a==null?void 0:a.event)=="created"||(a==null?void 0:a.event)=="updated"||(a==null?void 0:a.event)=="restored"?e.jsx("div",{className:"flex-1 w-1/2",children:e.jsx(d,{className:"bg-green-300 text-green-800 rounded-md w-full",severity:"success",content:e.jsx("div",{className:"flex justify-between w-full max-h-[250px] overflow-y-scroll",children:e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[((a==null?void 0:a.event)==="created"||(a==null?void 0:a.event)==="restored")&&a!==null?Object.keys(a.properties.attributes).map(t=>{if(t!="status.color")return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[n(t)," ",":"," ",t=="live_date"||t=="onboarding_date"||t=="monitoring_date_after_3_month_live"?p(a.properties.attributes[t]):a.properties.attributes[t]]}),e.jsx("hr",{className:" w-full bg-slate-300"})]})}):null,(a==null?void 0:a.event)=="updated"&&(a!==null?Object.keys(a.properties.attributes).map(t=>{if(t!="status.color")return a.properties.attributes[t]!==a.properties.old[t]&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[n(t)," ",":"," ",t=="live_date"||t=="onboarding_date"||t=="monitoring_date_after_3_month_live"?p(a.properties.attributes[t]):a.properties.attributes[t]]}),e.jsx("hr",{className:" w-full bg-slate-300"})]})}):null)]})})})}):null,(a==null?void 0:a.event)=="updated"?e.jsx("div",{className:"flex-1 w-1/2",children:e.jsx(d,{className:"bg-red-300 text-red-800 rounded-md w-full",severity:"success",content:e.jsx("div",{className:"flex justify-between w-full max-h-[250px] overflow-y-scroll",children:e.jsx("div",{className:"flex w-full flex-col gap-2",children:a!==null?Object.keys(a.properties.old).map(t=>{if(t!="status.color")return a.properties.attributes[t]!==a.properties.old[t]&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[n(t)," ",":"," ",a.properties.old[t]]}),e.jsx("hr",{className:" w-full bg-slate-300"})]})}):null})})})}):null,(a==null?void 0:a.event)=="deleted"?e.jsx("div",{className:"flex-1 ",children:e.jsx(d,{className:"bg-red-300 text-red-800 rounded-md w-full",severity:"success",content:e.jsx("div",{className:"flex justify-between w-full max-h-[250px] overflow-y-scroll",children:e.jsx("div",{className:"flex w-full flex-col gap-2",children:Object.keys(a.properties.old).map(t=>e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[n(t)," ",":"," ",a.properties.old[t]]}),e.jsx("hr",{className:" w-full bg-slate-300"})]}))})})})}):null]})})]})})};export{Z as default};
