import{r,F as pe,W as K,j as e,y as ba,b as g,R as ue,_ as he}from"./app-183ca207.js";import{D as A,C as d}from"./column.esm-1f1d87c0.js";import{T as ya}from"./toast.esm-b97f2233.js";import{B as c}from"./button.esm-d3cd2157.js";import{D as wa}from"./DashboardLayout-217cf030.js";import{H as ja}from"./HeaderModule-b06ca799.js";import{I as N}from"./inputtext.esm-0c7f541c.js";import{C as fe,c as xe}from"./confirmdialog.esm-3c4cbf5c.js";import{D as V}from"./dialog.esm-202fdef4.js";import{O}from"./overlaypanel.esm-9c3ae74e.js";import{P as ka}from"./progressspinner.esm-5c964cda.js";import{B as va}from"./badge.esm-c550247d.js";import{I as ge}from"./inputnumber.esm-6c4b14f0.js";import{C as I}from"./calendar.esm-fe4692a5.js";import{D as b}from"./dropdown.esm-0caba294.js";import{F as S,r as _a,p as Na}from"./filepond.min-8386e795.js";import{g as Sa}from"./getViewportSize-e6da2c0c.js";import{f as D}from"./formatDate-5c964a42.js";import{H as Ca}from"./HeaderDatatable-497e5508.js";import{S as Ta}from"./SkeletonDatatable-07c9c4e2.js";import{S as Fa}from"./sidebar.esm-1f854c9b.js";import{T as Ia,a as X}from"./tabview.esm-5482a716.js";import{f as Da}from"./formatNPWP-cf5b7efc.js";import{L as Pa,A as La}from"./ArsipComponent-6d496fd7.js";import{B as Ea,L as za}from"./blockui.esm-74c21695.js";import{h as Ba}from"./handleSelectedDetailInstitution-5c7c27d9.js";import"./ripple.esm-4b355069.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./portal.esm-545bb246.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./Dropdown-b69220a2.js";import"./index.esm-d51fec0e.js";import"./skeleton.esm-b303042b.js";import"./message.esm-4bbe4c64.js";import"./PermissionErrorDialog-eff24ba6.js";_a(Na);function Et({auth:k,partnersProp:W,signaturesProp:be,statusProp:ye,usersProp:we}){const[H,$]=r.useState([]),[q,Ma]=r.useState(W);r.useState(be);const[je,Ra]=r.useState(ye),[P,Ua]=r.useState(we),[L,ke]=r.useState(null);r.useState(W);const G=r.useRef(null),[ve,Ka]=r.useState([]),[J,_e]=r.useState(!1),[Ne,v]=r.useState(!1),[E,Se]=r.useState([]);r.useState(!0);const p=Sa().width<992,[Ce,Y]=r.useState(!1),[Te,Q]=r.useState(null),[Z,Fe]=r.useState(null),[y,Ie]=r.useState(0),ee=r.useRef(null),[De,C]=r.useState(null),z=r.useRef(null),[Pe,f]=r.useState(!1),[Le,T]=r.useState(!1),[Ee,B]=r.useState(!1),[ze,M]=r.useState(!1),Be=r.useRef(null),ae=r.useRef(null),[Me,Re]=r.useState(!0),F=r.useRef(null),{roles:Va,permissions:w}=k.user,[Ue,Ke]=r.useState(null);r.useState(!1);const[te,Ae]=r.useState({global:{value:null,matchMode:pe.CONTAINS}});r.useState({global:{value:null,matchMode:pe.CONTAINS}}),r.useState("");const{data:s,setData:i,post:Oa,put:Xa,delete:Ve,reset:j,processing:Wa,errors:re}=K({id:"",invoice_subscription:null,partner:{id:null,name:null},signature:{name:null,image:null},proof_of_transaction:null,date:null,nominal:null,money:null,payment_for:null,metode:null,rest_bill:null}),{data:Oe,setData:Xe,post:We,reset:He,processing:$e,errors:Ha}=K({partner:{excell:null,signature:{name:null,image:null}}}),{data:m,setData:_,reset:qe}=K({user:null,input_date:{start:null,end:null},payment_metode:null});r.useEffect(()=>{y==0&&le(x)},[y]),r.useEffect(()=>{L!==null&&h(L)},[L]),r.useEffect(()=>{J&&u("Import")},[J]);const le=async a=>{try{await Promise.all([a()]),v(!1),Re(t=>t=!1)}catch(t){console.error("Error fetching data:",t)}};r.useEffect(()=>{le(x)},[]);const[Ge,Je]=r.useState(""),Ye=a=>{const t=a.target.value;let n={...te};n.global.value=t,Ae(n),Je(t)},se=[{field:"code",header:"Kode",frozen:!p,style:p?null:{width:"max-content",whiteSpace:"nowrap"}},{header:"Lembaga",frozen:!p,style:{width:"max-content",whiteSpace:"nowrap"},body:a=>e.jsx("button",{onClick:()=>Ba(a),className:"hover:text-blue-700 text-left",children:a.partner_name})},{header:"Status",frozen:!p,style:{width:"max-content",whiteSpace:"nowrap"},body:a=>e.jsx(va,{value:a.status.name,className:"text-white",style:{backgroundColor:"#"+a.status.color}})},{field:"npwp",header:"NPWP",style:p?null:{width:"max-content",whiteSpace:"nowrap"},body:a=>{var t;return a.lead!=null?"-":((t=a.partner)==null?void 0:t.npwp)!==null?Da(a.partner.npwp):"-"}},{field:"invoice_general_doc",header:"Dokumen",style:p?null:{width:"max-content",whiteSpace:"nowrap"},body:a=>e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("a",{href:"/storage/"+a.invoice_subscription_doc,download:`Invoice_Subscription_${a.partner_name}`,class:"font-bold  w-full h-full text-center rounded-full ",children:e.jsx("i",{className:"pi pi-file-pdf",style:{width:"100%",height:"100%",fontSize:"1.5rem"}})})})},{field:"xendit_link",header:"Link Xendit",style:{width:"max-content",whiteSpace:"nowrap"},editor:a=>ia(a)},{field:"date",header:"Tanggal",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>D(a.date)},{field:"due_date",header:"Tanggal Jatuh Tempo",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>D(a.due_date)},{field:"bill_date",header:"Tanggal Pembayaran Terakhir",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.bill_date!==null?D(a.bill_date):"-"},{field:"total_nominal",header:"Total",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.total_nominal.toLocaleString("id")},{field:"total_ppn",header:"Pajak",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.total_ppn.toLocaleString("id")},{field:"paid_off",header:"Uang Muka",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.paid_off.toLocaleString("id")},{field:"rest_of_bill",header:"Sisa Tagihan",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.rest_of_bill.toLocaleString("id")},{field:"payment_metode",header:"Metode Pembayaran",style:{width:"max-content",whiteSpace:"nowrap"}}],x=async()=>{v(!0);let t=await(await fetch("/api/invoice_subscriptions")).json();$(n=>t),v(!1)},ne=async a=>{const t={method:"GET",url:`/api/convert/rupiah?nominal=${a}`,headers:{"Content-Type":"application/json"}};try{const l=(await g.request(t)).data;i(o=>({...o,nominal:a,money:l}))}catch(n){console.log(n)}},Qe=a=>e.jsx(ue.Fragment,{children:e.jsx("i",{className:"pi pi-ellipsis-h pointer cursor-pointer",onClick:t=>{Fe(a),G.current.toggle(t)}})}),u=a=>{F.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},h=a=>{F.current.show({severity:"error",summary:"Error",detail:a,life:3e3})},Ze=a=>{i({...s,uuid:a.uuid,invoice_subscription:a.invoice_id,partner:{id:a.partner_id,name:a.partner_name},date:a.date,nominal:a.nominal,money:a.money,metode:a.metode,proof_of_transaction:a.proof_of_transaction,payment_for:a.payment_for,signature:{name:a.signature_name,image:a.signature_image}})},ea=()=>{Ve("invoice_subscriptions/"+Z.uuid,{onSuccess:()=>{x(),u("Hapus")},onError:()=>{h("Hapus")}})},aa=a=>{xe({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:async()=>{g.delete("invoice_subscriptions/transaction/"+a.uuid,{headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}).then(t=>{t.data.error?h(t.data.error):(u("Tambah"),T(n=>!1),x(),j("nominal","date","money","payment_for","metode","signature"),i(n=>({...n,rest_bill:t.data.rest_of_bill})))})}})},ie=()=>e.jsx("i",{className:"pi pi-plus",style:{fontSize:"0.7rem",paddingRight:"5px"}}),oe=()=>{const a=H.map(t=>({Kode:t.code??"-",Lembaga:t.partner?t.partner.name:"-",NPWP:t.partner?t.partner.npwp:"-",Link_Dokumen:{v:window.location.origin+"/"+t.invoice_subscription_doc,h:"link",l:{Target:window.location.origin+"/storage/"+t.invoice_subscription_doc,Tooltip:"Klik untuk membuka dokumen"}},Tanggal_Pembuatan:D(t.created_at)}));he(()=>import("./xlsx-6ed613d4.js"),[]).then(t=>{const l={Sheets:{data:t.utils.json_to_sheet(a)},SheetNames:["data"]},o=t.write(l,{bookType:"xlsx",type:"array"});ta(o,"invoice_langganan")})},ta=(a,t)=>{he(()=>import("./FileSaver.min-a64440ff.js").then(n=>n.F),["assets/FileSaver.min-a64440ff.js","assets/app-183ca207.js","assets/app-22bdcf69.css"]).then(n=>{if(n&&n.default){let l="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",o=".xlsx";const ga=new Blob([a],{type:l});n.default.saveAs(ga,t+o)}})},ra=async a=>{a.preventDefault(),v(!0);const t={user:m.user,input_date:m.input_date,status:m.status},n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),o=(await g.post("/invoice_subscriptions/filter",t,{headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n}})).data;$(o),C(!1),v(!1)},la=()=>e.jsxs(Ca,{globalFilterValue:Ge,onGlobalFilterChange:Ye,setSidebarFilter:C,exportExcel:oe,isMobile:p,children:[e.jsx(c,{className:"shadow-md flex justify-center w-[10px] lg:w-[90px] border border-slate-600 bg-transparent text-slate-600 dark:bg-slate-700 dark:text-slate-300 rounded-lg",onClick:a=>{ua()},disabled:E.length<1,children:e.jsxs("span",{className:"w-full flex justify-center items-center gap-1",children:[e.jsx("i",{className:"pi pi-box",style:{fontSize:"0.8rem"}})," ",!p&&e.jsx("span",{children:"zip"})]})}),e.jsx(c,{className:"shadow-md w-[10px] lg:w-[90px] border border-slate-600 bg-transparent text-slate-600 dark:bg-slate-700 dark:text-slate-300 rounded-lg",onClick:()=>C(!0),children:e.jsxs("span",{className:"w-full flex justify-center items-center gap-1",children:[e.jsx("i",{className:"pi pi-filter",style:{fontSize:"0.7rem"}})," ",!p&&e.jsx("span",{children:"filter"})]})}),e.jsx(c,{className:"shadow-md w-[10px] lg:w-[90px] bg-transparent text-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:border rounded-lg",onClick:oe,"data-pr-tooltip":"XLS",children:e.jsxs("span",{className:"w-full flex items-center justify-center gap-1",children:[e.jsx("i",{className:"pi pi-file-excel",style:{fontSize:"0.8rem"}})," ",!p&&e.jsx("span",{children:"export"})]})})]}),sa=()=>{const a={xendit_link:Te};z.current.click(),g.put("invoice_subscriptions/"+s.uuid+"/xendit",a,{headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}).then(t=>{t.data.error?h(t.data.error):(u("Update"),x(),Q(n=>null),j())})},na=a=>(i(a.rowData),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{type:"text",className:"w-[10rem]",value:a.value,onChange:t=>{a.editorCallback(t.target.value),Q(t.target.value)},onKeyDown:t=>t.stopPropagation()}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(c,{icon:"pi pi-times",onClick:()=>{z.current.click()},className:"p-0 rounded-full bg-red-500  dark:text-white"}),e.jsx(c,{icon:"pi pi-check",className:"p-0 rounded-full bg-green-500  dark:text-white",onClick:sa})]})]})),ia=a=>na(a),R=(a,t)=>a?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}):e.jsx("span",{children:t.placeholder}),U=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),oa=e.jsx("div",{className:"flex flex-row gap-2 bg-gray-50 dark:bg-transparent p-2 rounded-lg align-items-center items-center justify-between justify-content-between",children:e.jsx("div",{className:"w-[15%]",children:w.includes("tambah transaksi")&&e.jsx(c,{label:"Input Pembayaran",className:"bg-purple-600 max-w-[146px] w-full text-xs shadow-md rounded-lg mr-2",icon:ie,onClick:()=>{T(a=>!0)},"aria-controls":"popup_menu_right","aria-haspopup":!0})})}),da=a=>a.bills.length>=0,ca=a=>{j("nominal","date","money","payment_for","metode","signature"),i(t=>({...t,invoice_subscription:a.data.uuid,partner:{...t.partner,name:a.data.partner_name,id:a.data.partner.id},rest_bill:a.data.rest_of_bill}))},ma=a=>e.jsxs(ue.Fragment,{children:[w.includes("edit transaksi")&&e.jsx(c,{icon:"pi pi-pencil",rounded:!0,outlined:!0,className:"mr-2",onClick:()=>{B(!0),Ze(a)}}),w.includes("hapus transaksi")&&e.jsx(c,{icon:"pi pi-trash",rounded:!0,outlined:!0,severity:"danger",onClick:()=>{aa(a)}})]}),pa=a=>e.jsx("div",{className:"md:px-14 pb-2",children:e.jsx("div",{className:"flex",children:e.jsxs(A,{headerClassName:"bg-red-500",value:a.transactions,className:"",header:oa,emptyMessage:"Transaksi tidak ditemukan.",children:[e.jsx(d,{header:"No",body:(t,{rowIndex:n})=>n+1,style:{width:"1rem"},className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"date",header:"Tanggal",style:{minWidth:"10rem"},body:t=>new Date(t.date).toLocaleDateString("id"),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"nominal",header:"Nominal",style:{minWidth:"8rem"},body:t=>t.nominal.toLocaleString("id-ID"),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"money",header:"Uang Terbilang",style:{minWidth:"10rem"},headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"metode",header:"Metode",style:{minWidth:"8rem"},headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"proof_of_transaction",header:"Bukti",style:{width:"max-content",whiteSpace:"nowrap"},headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300",body:t=>e.jsx("div",{className:"w-[100px] h-[100px] bg-no-repeat bg-contain rounded-t-xl",style:{backgroundImage:`url(${t.proof_of_transaction})`,backgroundPosition:"center",backgroundSize:"contain"}})}),e.jsx(d,{field:"created_by",header:"Diinput Oleh",style:{minWidth:"8rem"},body:t=>t.user.name,headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{body:t=>t.receipt_doc==""?e.jsx(ka,{style:{width:"30px",height:"30px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s"}):e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("a",{href:t.receipt_doc,download:`Kwitansi_${t.partner_name}`,class:"font-bold  w-full h-full text-center rounded-full ",children:e.jsx("i",{className:"pi pi-file-pdf",style:{width:"100%",height:"100%",fontSize:"1.5rem"}})})}),className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300",align:"left",header:"Dokumen",style:{minWidth:"2rem"}}),e.jsx(d,{header:"Action",body:ma,style:{minWidth:"12rem"},className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"})]})})}),de=(a,t)=>{a.preventDefault(),f(!0);const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content");t==="tambah"?g.post("/invoice_subscriptions/transaction",{...s},{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":n}}).then(l=>{l.data.error?(h(l.data.error),f(!1)):(f(!1),u("Tambah"),T(o=>!1),x(),j("nominal","date","money","payment_for","metode","signature"),i(o=>({...o,rest_bill:l.data.rest_of_bill})))}):g.post("/invoice_subscriptions/transaction/"+s.uuid,{...s},{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}).then(l=>{l.data.error?(h(l.data.error),f(!1)):(u("Update"),B(o=>!1),f(!1),x(),j("nominal","date","money","payment_for","metode","signature"),i(o=>({...o,rest_bill:l.data.rest_of_bill})))})},ce=()=>{F.current.clear()},ua=async a=>{g.post("/invoice_subscriptions/zip",{selectedInvoices:E},{headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}).then(t=>{const l=`data:application/zip;base64,${t.data.zip_blob}`,o=document.createElement("a");o.href=l,o.download="invoice_langganan.zip",document.body.appendChild(o),o.click(),document.body.removeChild(o)})},me=["partner.name","date","code","status.name","period"],ha=(a,t)=>{a.preventDefault(),f(!0),M(n=>!1),We("/invoice_subscriptions/batch",{onSuccess:()=>{u("Tambah"),x(),_e(!0),f(!1),He(),ce()},onError:n=>{h("Tambah"),ce(),f(!1),ke(n.error)}})},fa=()=>{xe({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:()=>{Y(!0)}})},xa=a=>{let t;const l=a.split(".")[0];return l=="partner_name"?t="Lembaga":l=="partner_npwp"?t="NPWP":l=="date"?t="Tanggal":l=="due_date"?t="Jatuh Tempo":l=="invoice_age"?t="Umur Invoice":l=="bill_date"?t="Tanggal Pembayaran Terakhir":l=="total"?t="Total":l=="total_all_ppn"?t="Pajak":l=="paid_off"?t="Uang Muka atau Diskon":l=="signature_name"?t="Tanda Tangan":l=="payment_metode"?t="Metode Pembayaran":l=="xendit_link"?t="Link Xendit":l=="code"?t="Kode":l=="rest_of_bill"?t="Sisa Tagihan":l=="products"?t="List Produk":l=="money"?t="Uang Terbilang":l=="partner_name"?t="Lembaga":l=="nominal"?t="Nominal":l=="payment_for"&&(t="Pembayaran Untuk"),t};return Me?e.jsx(Ta,{auth:k}):e.jsx(Ea,{blocked:Pe,template:za,children:e.jsxs(wa,{auth:k.user,className:"",children:[e.jsx(ya,{ref:F}),e.jsx(Fa,{header:"Filter",visible:De,className:"w-full md:w-[30%] px-3 dark:glass dark:text-white",position:"right",onHide:()=>C(!1),children:e.jsxs("form",{onSubmit:ra,children:[e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"name",children:"Berdasarkan penginput"}),e.jsx(b,{optionLabel:"name",dataKey:"id",value:m.user,onChange:a=>_("user",a.target.value),options:P,placeholder:"Pilih User",filter:!0,showClear:!0,valueTemplate:R,itemTemplate:U,className:"flex justify-center  dark:text-gray-400   "})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"status",children:"Status "}),e.jsx(b,{dataKey:"name",value:m.status,onChange:a=>{_("status",a.target.value)},options:je,optionLabel:"name",placeholder:"Pilih Status",className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"metode",children:"Metode *"}),e.jsx(b,{value:m.payment_metode,onChange:a=>_("payment_metode",a.target.value),options:[{name:"Tunai"},{name:"Cazhbox"},{name:"Transfer Bank"}],optionLabel:"name",placeholder:"Pilih metode",className:"w-full md:w-14rem",editable:!0})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"",children:"Tanggal Input"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{value:m.input_date.start?new Date(m.input_date.start):null,style:{height:"35px"},onChange:a=>{_("input_date",{...m.input_date,start:a.target.value})},placeholder:"mulai",showIcon:!0,dateFormat:"dd/mm/yy"}),e.jsx("span",{children:"-"}),e.jsx(I,{value:m.input_date.end?new Date(m.input_date.end):null,style:{height:"35px"},onChange:a=>{_("input_date",{...m.input_date,end:a.target.value})},placeholder:"selesai",showIcon:!0,dateFormat:"dd/mm/yy"})]})]}),e.jsxs("div",{className:"flex flex-row mt-5",children:[e.jsx(c,{ref:ee,label:"Terapkan",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2"}),e.jsx(c,{type:"button",label:"Reset",onClick:a=>{qe(),setTimeout(()=>{ee.current.click()},500)},className:"outline-purple-600 outline-1 outline-dotted bg-transparent text-slate-700  text-sm shadow-md rounded-lg mr-2"})]})]})}),e.jsx(O,{className:" shadow-md p-1 dark:bg-slate-800 dark:text-gray-300",ref:G,children:e.jsxs("div",{className:"flex flex-col flex-wrap w-full",children:[w.includes("edit invoice langganan")&&e.jsx(c,{icon:"pi pi-pencil",label:"edit",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{ba.get("/invoice_langganan/"+Z.uuid)}}),w.includes("hapus invoice langganan")&&e.jsx(c,{icon:"pi pi-trash",label:"hapus",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{fa()}})]})}),e.jsx(ja,{title:"Invoice Langganan",children:w.includes("tambah invoice langganan")&&e.jsxs(e.Fragment,{children:[e.jsx(c,{label:"Tambah",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2",icon:ie,onClick:a=>ae.current.toggle(a)}),e.jsx(O,{ref:ae,className:"shadow-md dark:bg-slate-800 dark:text-white",children:e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("span",{children:e.jsx(c,{label:"satuan",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 dark:hover:text-slate-900 dark:text-white border-b-2 border-slate-400",onClick:()=>{window.location.href="/invoice_subscriptions/create"},"aria-controls":"popup_menu_right","aria-haspopup":!0})}),e.jsx("span",{children:e.jsx(c,{label:"massal",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 dark:hover:text-slate-900 dark:text-white border-b-2 border-slate-400",onClick:()=>{M(a=>!0),j()},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]})})]})}),e.jsxs(Ia,{activeIndex:y,onTabChange:a=>{Ie(a.index)},className:"mt-2",children:[e.jsx(X,{header:"Semua Invoice",children:y==0&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{}),e.jsx(fe,{group:"declarative",visible:Ce,onHide:()=>Y(!1),message:"Konfirmasi kembali jika anda yakin!",header:"Konfirmasi kembali",icon:"pi pi-info-circle",accept:ea}),e.jsx("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",ref:z,children:e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(A,{loading:Ne,className:"w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:""},paginator:!0,rowsPerPageOptions:[10,25,50,100],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",filters:te,rows:10,emptyMessage:"Invoice langganan tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:la,value:H,dataKey:"id",selection:E,onSelectionChange:a=>Se(a.value),expandedRows:Ue,onRowToggle:a=>{Ke(a.data)},globalFilterFields:me,scrollable:!0,globalFilterMatchMode:"contains",rowExpansionTemplate:pa,selectionMode:"checkbox",onRowExpand:ca,editMode:"cell",children:[e.jsx(d,{expander:da,style:{width:"max-content",whiteSpace:"nowrap"},frozen:!0,className:"bg-white dark:bg-slate-900",headerClassName:"bg-white dark:bg-slate-900"}),e.jsx(d,{selectionMode:"multiple",exportable:!1,frozen:!0,className:"bg-white dark:bg-slate-900",headerClassName:"bg-white dark:bg-slate-900"}),e.jsx(d,{header:"Aksi",body:Qe,style:{width:"max-content",whiteSpace:"nowrap"},frozen:!0,align:"center",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}),se.map(a=>e.jsx(d,{field:a.field,header:a.header,body:a.body,style:a.style,frozen:a.frozen,editor:a.editor,align:"left",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}))]})})})]})}),e.jsx(X,{header:"Log",children:y==1&&e.jsx(Pa,{auth:k,fetchUrl:"/api/invoice_subscriptions/logs",filterUrl:"/invoice_subscriptions/logs/filter",deleteUrl:"/invoice_subscriptions/logs",objectKeyToIndo:xa,users:P,showSuccess:u,showError:h})}),e.jsx(X,{header:"Arsip",children:y==2&&e.jsx(La,{auth:k,users:P,fetchUrl:"/api/invoice_subscriptions/arsip",forceDeleteUrl:"/invoice_subscriptions/{id}/force",restoreUrl:"/invoice_subscriptions/{id}/restore",filterUrl:"/invoice_subscriptions/arsip/filter",columns:se,showSuccess:u,showError:h,globalFilterFields:me})})]}),e.jsx(O,{className:"w-[95%] md:max-w-[50%] dark:bg-slate-900 dark:text-gray-300",ref:Be,showCloseIcon:!0,children:e.jsxs(A,{value:ve,className:"my-4 overflow-x-auto w-full",emptyMessage:"Produk tidak ditemukan.",children:[e.jsx(d,{header:"No",body:(a,{rowIndex:t})=>t+1,style:{width:"max-content",whiteSpace:"nowrap"},className:"dark:border-none",headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"bill",header:"Tagihan",style:{width:"max-content",whiteSpace:"nowrap"},headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"nominal",header:"Nominal",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.nominal.toLocaleString("id-ID"),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"ppn",header:"Pajak (%)",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.ppn,headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"Pajak",header:"Pajak",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.total_ppn.toLocaleString("id-ID"),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"}),e.jsx(d,{field:"total_bill",header:"Jumlah",style:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.total_bill.toLocaleString("id-ID"),headerClassName:"dark:border-none bg-gray-50 dark:bg-transparent dark:text-gray-300"})]})}),e.jsx(V,{header:"Invoice Massal",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:ze,onHide:()=>M(!1),children:e.jsxs("form",{onSubmit:a=>ha(a),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex bg-green-600 text-white text-xs p-3 rounded-lg justify-between w-full h-full",children:[e.jsx("p",{children:"Template"}),e.jsx("p",{className:"font-semibold",children:e.jsx("a",{href:"/assets/template/excel/invoice_sample.csv",download:"sample.csv",class:"font-bold underline w-full h-full text-center rounded-full ",children:"sample.csv"})})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"name",children:"CSV"}),e.jsx("div",{className:"App",children:e.jsx(S,{onaddfile:(a,t)=>{Xe("partner",{...Oe.partner,excell:t.file})},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",name:"files",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(c,{label:"Submit",disabled:$e,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(V,{header:"Input Pembayaran",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:Le,onHide:()=>T(!1),children:e.jsxs("form",{onSubmit:a=>de(a,"tambah"),children:[e.jsx("div",{className:"flex flex-col mt-3",children:e.jsxs("div",{className:"flex bg-purple-600 text-white text-xs p-3 rounded-lg justify-between w-full h-full",children:[e.jsx("p",{children:"Sisa tagihan"}),e.jsxs("p",{className:"font-semibold",children:["Rp"," ",s.rest_bill?s.rest_bill.toLocaleString("id-ID"):0]})]})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"date",children:"Tanggal *"}),e.jsx(I,{value:s.date?new Date(s.date):null,style:{height:"35px"},onChange:a=>{i("date",a.target.value)},showIcon:!0,dateFormat:"dd-mm-yy",className:`w-full md:w-14rem ${re.date&&"p-invalid"}`})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"money",children:"Diterima Dari *"}),e.jsx(b,{value:s.partner,dataKey:"id",onChange:a=>{i("partner",{...s.partner,id:a.target.value.id,name:a.target.value.name})},options:q,optionLabel:"name",placeholder:"Pilih Lembaga",filter:!0,disabled:!0,valueTemplate:R,itemTemplate:U,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col justify-around mt-3",children:[e.jsx("label",{htmlFor:"nominal",children:"Nominal *"}),e.jsx(ge,{value:s.nominal,onValueChange:a=>{ne(a.value)},defaultValue:0,className:"dark:bg-gray-300",id:"nominal","aria-describedby":"nominal-help",locale:"id-ID"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"money",children:"Uang Terbilang *"}),e.jsx(N,{value:s.money,onChange:a=>i("money",a.target.value),className:"dark:bg-gray-300",id:"money","aria-describedby":"money-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"payment_for",children:"Pembayaran Untuk *"}),e.jsx(N,{value:s.payment_for,onChange:a=>i("payment_for",a.target.value),className:"dark:bg-gray-300",id:"payment_for","aria-describedby":"payment_for-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"metode",children:"Metode *"}),e.jsx(b,{value:s.metode,onChange:a=>i("metode",a.target.value),options:[{name:"Tunai"},{name:"Cazhbox"},{name:"Transfer Bank"}],optionLabel:"name",placeholder:"Pilih Metode",className:"w-full md:w-14rem",editable:!0})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"proof_of_transaction",children:"Bukti (foto) *"}),e.jsx("div",{className:"App",children:s.proof_of_transaction!==null&&typeof s.proof_of_transaction=="string"?e.jsx(e.Fragment,{children:e.jsx(S,{files:s.proof_of_transaction,onaddfile:(a,t)=>{a||i("proof_of_transaction",t.file)},onremovefile:()=>{i("proof_of_transaction",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(S,{onaddfile:(a,t)=>{a||i("proof_of_transaction",t.file)},onremovefile:()=>{i("proof_of_transaction",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]}),e.jsx("div",{className:"flex justify-center my-5",children:e.jsx(c,{label:"Submit",className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(V,{header:"Input Pembayaran",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:Ee,onHide:()=>B(!1),children:e.jsxs("form",{onSubmit:a=>de(a,"update"),children:[e.jsx("div",{className:"flex flex-col mt-3",children:e.jsxs("div",{className:"flex bg-purple-600 text-white text-xs p-3 rounded-lg justify-between w-full h-full",children:[e.jsx("p",{children:"Sisa tagihan"}),e.jsxs("p",{className:"font-semibold",children:["Rp"," ",s.rest_bill?s.rest_bill.toLocaleString("id-ID"):0]})]})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"date",children:"Tanggal *"}),e.jsx(I,{value:s.date?new Date(s.date):null,style:{height:"35px"},onChange:a=>{i("date",a.target.value)},showIcon:!0,dateFormat:"dd-mm-yy",className:`w-full md:w-14rem ${re.date&&"p-invalid"}`})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"money",children:"Diterima Dari *"}),e.jsx(b,{value:s.partner,dataKey:"id",onChange:a=>{i("partner",{...s.partner,id:a.target.value.id,name:a.target.value.name})},options:q,optionLabel:"name",placeholder:"Pilih Lembaga",filter:!0,valueTemplate:R,itemTemplate:U,className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col justify-around mt-3",children:[e.jsx("label",{htmlFor:"nominal",children:"Nominal *"}),e.jsx(ge,{value:s.nominal,onValueChange:a=>{ne(a.value)},defaultValue:0,className:"dark:bg-gray-300",id:"nominal","aria-describedby":"nominal-help",locale:"id-ID"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"money",children:"Uang Terbilang *"}),e.jsx(N,{value:s.money,onChange:a=>i("money",a.target.value),className:"dark:bg-gray-300",id:"money","aria-describedby":"money-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"payment_for",children:"Pembayaran Untuk *"}),e.jsx(N,{value:s.payment_for,onChange:a=>i("payment_for",a.target.value),className:"dark:bg-gray-300",id:"payment_for","aria-describedby":"payment_for-help"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"metode",children:"Metode *"}),e.jsx(b,{value:s.metode,onChange:a=>i("metode",a.target.value),options:[{name:"Tunai"},{name:"Cazhbox"},{name:"Transfer Bank"}],optionLabel:"name",placeholder:"Pilih Metode",className:"w-full md:w-14rem",editable:!0})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"proof_of_transaction",children:"Bukti (foto) *"}),e.jsx("div",{className:"App",children:s.proof_of_transaction!==null&&typeof s.proof_of_transaction=="string"?e.jsx(e.Fragment,{children:e.jsx(S,{files:s.proof_of_transaction,onaddfile:(a,t)=>{a||i("proof_of_transaction",t.file)},onremovefile:()=>{i("proof_of_transaction",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})}):e.jsx(e.Fragment,{children:e.jsx(S,{onaddfile:(a,t)=>{a||i("proof_of_transaction",t.file)},onremovefile:()=>{i("proof_of_transaction",null)},maxFileSize:"2mb",labelMaxFileSizeExceeded:"File terlalu besar",labelIdle:'Drag & Drop your files or <span class="filepond--label-action">Browse</span>'})})})]}),e.jsx("div",{className:"flex justify-center my-5",children:e.jsx(c,{label:"Submit",className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})})]})})}export{Et as default};
