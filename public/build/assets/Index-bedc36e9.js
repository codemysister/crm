import{r as s,F as pe,W as I,j as e,d as me,y as ue,R as he,_ as H}from"./app-183ca207.js";import{D as fe,C as F}from"./column.esm-1f1d87c0.js";import{T as ge}from"./toast.esm-b97f2233.js";import{B as d}from"./button.esm-d3cd2157.js";import{D as xe}from"./DashboardLayout-217cf030.js";import{H as we}from"./HeaderModule-b06ca799.js";import{C as K,c as be}from"./confirmdialog.esm-3c4cbf5c.js";import{O as _e}from"./overlaypanel.esm-9c3ae74e.js";import{g as ye}from"./getViewportSize-e6da2c0c.js";import{S as ke}from"./sidebar.esm-1f854c9b.js";import{S as je}from"./SkeletonDatatable-07c9c4e2.js";import{H as Se}from"./HeaderDatatable-497e5508.js";import{T as ve,a as j}from"./tabview.esm-5482a716.js";import{D as R}from"./dropdown.esm-0caba294.js";import{C as O}from"./calendar.esm-fe4692a5.js";import{f as Ne}from"./formatNPWP-cf5b7efc.js";import{L as Te,A as Ce}from"./ArsipComponent-6d496fd7.js";import{h as De}from"./handleSelectedDetailInstitution-5c7c27d9.js";import{f as U}from"./formatDate-5c964a42.js";import{P as Pe}from"./PermissionErrorDialog-eff24ba6.js";import"./ripple.esm-4b355069.js";import"./inputnumber.esm-6c4b14f0.js";import"./inputtext.esm-0c7f541c.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./portal.esm-545bb246.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./Dropdown-b69220a2.js";import"./dialog.esm-202fdef4.js";import"./skeleton.esm-b303042b.js";import"./index.esm-d51fec0e.js";import"./badge.esm-c550247d.js";import"./message.esm-4bbe4c64.js";function va({auth:c,usersProp:A}){const[S,v]=s.useState();s.useState({partner_name:null,code:null,word:null,pdf:null});const[u,B]=s.useState(null),[f,Le]=s.useState(A),[M,p]=s.useState(!1),[V,W]=s.useState(!0),l=ye().width<992,[X,N]=s.useState(!1),[o,$]=s.useState(0);s.useRef(null);const T=s.useRef(null),C=s.useRef(null),[q,g]=s.useState(null),Q=s.useRef(null),x=s.useRef(null),{roles:Ee,permissions:w,data:D}=c.user,[Y,b]=s.useState(!1),[P,G]=s.useState({global:{value:null,matchMode:pe.CONTAINS}}),L=[{field:"code",header:"Kode",frozen:!l,style:l?null:{width:"max-content",whiteSpace:"nowrap"}},{header:"Lembaga",frozen:!l,style:{width:"max-content",whiteSpace:"nowrap"},body:t=>e.jsx("button",{onClick:()=>De(t),className:"hover:text-blue-700 text-left",children:t.partner_name})},{field:"npwp",header:"NPWP",frozen:!l,style:l?null:{width:"max-content",whiteSpace:"nowrap"},body:t=>{var a;return t.lead!=null?"-":((a=t.partner)==null?void 0:a.npwp)!==null?Ne(t.partner.npwp):"-"}},{field:"mou_doc",header:"Dokumen",frozen:!l,style:l?null:{width:"max-content",whiteSpace:"nowrap"},body:t=>e.jsx("div",{className:"flex w-full h-full items-center justify-center",children:e.jsx("a",{href:t.mou_doc,download:`MOU_${t.partner_name}`,class:"font-bold  w-full h-full text-center rounded-full ",children:e.jsx("i",{className:"pi pi-file-pdf",style:{width:"100%",height:"100%",fontSize:"1.5rem"}})})})},{field:"partner_pic",header:"PIC",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"url_subdomain",header:"Url Subdomain",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"price_card",header:"Harga Kartu",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"price_lanyard",header:"Harga Lanyard",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"price_subscription_system",header:"Harga Langganan Sistem",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"period_subscription",header:"Langganan Per-",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"price_training_offline",header:"Harga Training Offline",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"price_training_online",header:"Harga Training Online",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"fee_purchase_cazhpoin",header:"Isi Kartu via CazhPOIN",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"fee_bill_cazhpoin",header:"Bayar Tagihan via CazhPOIN",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"fee_topup_cazhpos",header:"Topup Kartu via CazhPos",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"fee_withdraw_cazhpos",header:"Withdraw Kartu via Cazh POS",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"fee_bill_saldokartu",header:"Bayar Tagihan via Saldo Kartu",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"bank",header:"Bank",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"account_bank_number",header:"Nomor Rekening",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"expired_date",header:"Tanggal Kadaluarsa",style:{width:"max-content",whiteSpace:"nowrap"}},{field:"profit_sharing",header:"Bagi Hasil",style:{width:"max-content",whiteSpace:"nowrap"}}],{data:Ie,setData:He,post:Fe,put:Ke,delete:J,reset:Re,processing:Oe,errors:Ue}=I({uuid:"",name:"",category:"",price:"",unit:"",description:""}),{data:i,setData:h,reset:Z}=I({user:null,input_date:{start:null,end:null},institution_type:null});s.useState("");const _=async()=>{p(!0);let a=await(await fetch("/api/mou")).json();v(n=>a),p(!1)};s.useEffect(()=>{o==0&&z(_)},[o]),s.useEffect(()=>{z(_)},[]);const z=async t=>{try{await Promise.all([t()]),p(!1),W(a=>a=!1)}catch(a){console.error("Error fetching data:",a)}},ee=t=>e.jsx(he.Fragment,{children:e.jsx("i",{className:"pi pi-ellipsis-h pointer cursor-pointer",onClick:a=>{B(t),T.current.toggle(a)}})}),ae=(t,a)=>t?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:t.name})}):e.jsx("span",{children:a.placeholder}),te=t=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:t.name})}),re=()=>{const t=S.map(a=>({Kode:a.code??"-",Lembaga:a.partner_name??"-",NPWP:a.lead==null?a.partner.npwp:"-",Link_Dokumen:{v:window.location.origin+"/"+a.memo_doc,h:"link",l:{Target:window.location.origin+"/"+a.memo_doc,Tooltip:"Klik untuk membuka dokumen"}},Tanggal_Pembuatan:U(a.created_at),Diinput_Oleh:a.created_at.name}));H(()=>import("./xlsx-6ed613d4.js"),[]).then(a=>{const r={Sheets:{data:a.utils.json_to_sheet(t)},SheetNames:["data"]},m=a.write(r,{bookType:"xlsx",type:"array"});se(m,"memo_"+U(new Date))})},se=(t,a)=>{H(()=>import("./FileSaver.min-a64440ff.js").then(n=>n.F),["assets/FileSaver.min-a64440ff.js","assets/app-183ca207.js","assets/app-22bdcf69.css"]).then(n=>{if(n&&n.default){let r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",m=".xlsx";const ce=new Blob([t],{type:r});n.default.saveAs(ce,a+m)}})},y=t=>{x.current.show({severity:"success",summary:"Success",detail:`${t} data berhasil`,life:3e3})},k=t=>{x.current.show({severity:"error",summary:"Error",detail:`${t} data gagal`,life:3e3})},ie=()=>{J("mou/"+u.uuid,{onSuccess:()=>{_(),y("Hapus")},onError:()=>{k("Hapus")}})},ne=()=>{be({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:()=>{N(!0)}})},le=async t=>{t.preventDefault(),p(!0);const a={user:i.user,input_date:i.input_date,institution_type:i.institution_type},n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),m=(await axios.post("/mou/filter",a,{headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n}})).data;v(m),g(!1),p(!1)},E=["partner_name","code","date"],oe=t=>{let a;const r=t.split(".")[0];return r=="code"?a="Kode":r=="date"?a="Tanggal Kesepakatan":r=="partner_name"?a="Lembaga":r=="partner_pic"?a="PIC":r=="url_subdomain"?a="Url Subdomain":r=="price_card"?a="Harga Kartu":r=="price_lanyard"?a="Harga Lanyard":r=="price_subscription_system"?a="Harga Langganan Sistem":r=="period_subscription"?a="Periode Langganan":r=="price_training_offline"?a="Harga Training Offline":r=="price_training_online"?a="Harga Training Online":r=="fee_qris"?a="Harga QRIS":r=="fee_purchase_cazhpoin"?a="Harga Pembelian Cazhpoin":r=="fee_withdraw_cazhpos"?a="Harga Penarikan Cazhpos":r=="fee_bill_saldokartu"?a="Harga Pembayaran Saldokartu":r=="bank"?a="Bank Lembaga":r=="account_bank_number"?a="No Rekening Lembaga":r=="account_bank_name"?a="Atas Nama Bank Lembaga":r=="expired_date"?a="Tanggal Kadaluarsa":r=="profit_sharing"?a="Bagi Hasil":r=="profit_sharing_detail"?a="Detail Bagi Hasil":r=="signature_name"&&(a="Tanda Tangan"),a},de=()=>e.jsxs(Se,{filters:P,setFilters:G,children:[e.jsx(d,{className:"shadow-md w-[10px] lg:w-[90px] border border-slate-600 bg-transparent text-slate-600 dark:bg-slate-700 dark:text-slate-300 rounded-lg",onClick:()=>g(!0),children:e.jsxs("span",{className:"w-full flex justify-center items-center gap-1",children:[e.jsx("i",{className:"pi pi-filter",style:{fontSize:"0.7rem"}})," ",!l&&e.jsx("span",{children:"filter"})]})}),e.jsx(d,{className:"shadow-md w-[10px] lg:w-[90px] bg-transparent text-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:border rounded-lg",onClick:re,"data-pr-tooltip":"XLS",children:e.jsxs("span",{className:"w-full flex items-center justify-center gap-1",children:[e.jsx("i",{className:"pi pi-file-excel",style:{fontSize:"0.8rem"}})," ",!l&&e.jsx("span",{children:"export"})]})})]});return V?e.jsx(je,{auth:c}):e.jsxs(xe,{auth:c.user,className:"",children:[e.jsx(ge,{ref:x}),e.jsx(Pe,{dialogIsVisible:Y,setDialogVisible:b}),e.jsx(we,{title:"Mou",children:w.includes("tambah mou")&&e.jsxs(me,{href:"/mou/create",className:"bg-purple-600 block text-white py-2 px-3 font-semibold text-sm shadow-md rounded-lg mr-2",children:[e.jsx("i",{className:"pi pi-plus",style:{fontSize:"0.7rem",paddingRight:"5px"}}),"Tambah"]})}),e.jsx(ke,{header:"Filter",visible:q,className:"w-full md:w-[30%] px-3 dark:glass dark:text-white",position:"right",onHide:()=>g(!1),children:e.jsxs("form",{onSubmit:le,children:[e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"name",children:"Berdasarkan penginput"}),e.jsx(R,{optionLabel:"name",dataKey:"id",value:i.user,onChange:t=>h("user",t.target.value),options:f,placeholder:"Pilih User",filter:!0,showClear:!0,valueTemplate:ae,itemTemplate:te,className:"flex justify-center  dark:text-gray-400   "})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"institution_type",children:"Tipe Lembaga"}),e.jsx(R,{value:i.institution_type,onChange:t=>h("institution_type",t.target.value),showClear:!0,options:[{name:"Lead"},{name:"Partner"}],optionLabel:"name",optionValue:"name",placeholder:"Pilih tipe",className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"",children:"Tanggal Input"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{value:i.input_date.start?new Date(i.input_date.start):null,style:{height:"35px"},onChange:t=>{h("input_date",{...i.input_date,start:t.target.value})},placeholder:"mulai",showIcon:!0,dateFormat:"dd/mm/yy"}),e.jsx("span",{children:"-"}),e.jsx(O,{value:i.input_date.end?new Date(i.input_date.end):null,style:{height:"35px"},onChange:t=>{h("input_date",{...i.input_date,end:t.target.value})},placeholder:"selesai",showIcon:!0,dateFormat:"dd/mm/yy"})]})]}),e.jsxs("div",{className:"flex flex-row mt-5",children:[e.jsx(d,{ref:C,label:"Terapkan",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2"}),e.jsx(d,{type:"button",label:"Reset",onClick:t=>{Z(),setTimeout(()=>{C.current.click()},500)},className:"outline-purple-600 outline-1 outline-dotted bg-transparent text-slate-700  text-sm shadow-md rounded-lg mr-2"})]})]})}),e.jsx(_e,{className:" shadow-md p-1 dark:bg-slate-800 dark:text-gray-300",ref:T,children:e.jsxs("div",{className:"flex flex-col flex-wrap w-full",children:[e.jsx(d,{icon:"pi pi-pencil",label:"edit",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{w.includes("edit mou")&&u.created_by.id==D.id?ue.get("/mou/"+u.uuid):b(t=>!0)}}),e.jsx(d,{icon:"pi pi-trash",label:"hapus",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{w.includes("hapus mou")&&u.created_by.id==D.id?ne():b(t=>!0)}})]})}),e.jsxs(ve,{activeIndex:o,onTabChange:t=>{$(t.index)},className:"mt-2",children:[e.jsx(j,{header:"Semua Mou",children:o==0&&e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(K,{group:"declarative",visible:X,onHide:()=>N(!1),message:"Konfirmasi kembali jika anda yakin!",header:"Konfirmasi kembali",icon:"pi pi-info-circle",accept:ie}),e.jsx("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",ref:Q,children:e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(fe,{loading:M,className:"w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white rounded-lg dark:text-gray-300",header:""},paginator:!0,filters:P,rows:5,emptyMessage:"Mou tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:de,value:S,globalFilterFields:E,dataKey:"id",children:[e.jsx(F,{header:"Aksi",body:ee,style:{width:"max-content",whiteSpace:"nowrap"},frozen:!0,align:"center",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}),L.map(t=>e.jsx(F,{field:t.field,header:t.header,body:t.body,style:t.style,frozen:t.frozen,align:"left",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}))]})})})]})}),e.jsx(j,{header:"Log",children:o==1&&e.jsx(Te,{auth:c,fetchUrl:"/api/mou/logs",filterUrl:"/mou/logs/filter",deleteUrl:"/mou/logs",objectKeyToIndo:oe,users:f,showSuccess:y,showError:k})}),e.jsx(j,{header:"Arsip",children:o==2&&e.jsx(Ce,{auth:c,users:f,fetchUrl:"/api/mou/arsip",forceDeleteUrl:"/mou/{id}/force",restoreUrl:"/mou/{id}/restore",filterUrl:"/mou/arsip/filter",columns:L,showSuccess:y,showError:k,globalFilterFields:E})})]})]})}export{va as default};
