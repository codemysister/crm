import{r as s,F as ne,W as de,j as e,R as ce}from"./app-183ca207.js";import{D as me,C as h}from"./column.esm-1f1d87c0.js";import{T as pe}from"./toast.esm-b97f2233.js";import{B as p}from"./button.esm-d3cd2157.js";import{D as ue}from"./DashboardLayout-217cf030.js";import{H as he}from"./HeaderModule-b06ca799.js";import{D as E}from"./dialog.esm-202fdef4.js";import{I as g}from"./inputtext.esm-0c7f541c.js";import{D as R}from"./dropdown.esm-0caba294.js";import{I as U}from"./inputtextarea.esm-555f4aba.js";import{C as z,c as ge}from"./confirmdialog.esm-3c4cbf5c.js";import{I as K}from"./inputnumber.esm-6c4b14f0.js";import{g as fe}from"./getViewportSize-e6da2c0c.js";import{H as xe}from"./HeaderDatatable-497e5508.js";import{S as be}from"./SkeletonDatatable-07c9c4e2.js";import{O as we}from"./overlaypanel.esm-9c3ae74e.js";import{T as je,a as j}from"./tabview.esm-5482a716.js";import{f as ye}from"./formatDate-5c964a42.js";import{L as ke,A as ve}from"./ArsipComponent-6d496fd7.js";import"./ripple.esm-4b355069.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./portal.esm-545bb246.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./Dropdown-b69220a2.js";import"./skeleton.esm-b303042b.js";import"./index.esm-d51fec0e.js";import"./badge.esm-c550247d.js";import"./calendar.esm-fe4692a5.js";import"./message.esm-4bbe4c64.js";import"./sidebar.esm-1f854c9b.js";import"./PermissionErrorDialog-eff24ba6.js";function pa({auth:n,usersProp:V}){const[o,A]=s.useState(0),[M,_]=s.useState(null),[O,u]=s.useState(!1),[y,Ne]=s.useState(V),[k,B]=s.useState(null),[$,v]=s.useState(!1),[W,N]=s.useState(!0),[q,f]=s.useState(!1),[G,x]=s.useState(!1),b=s.useRef(null),S=s.useRef(null),i=fe().width<992,C=s.useRef(null),{roles:Ce,permissions:J}=n.user,[D,Q]=s.useState({global:{value:null,matchMode:ne.CONTAINS}}),{data:l,setData:t,post:X,put:Y,delete:Z,reset:w,processing:P,errors:De}=de({id:"",name:"",category:"",price:"",unit:"",description:""});s.useEffect(()=>{o==0&&ee(d)},[o]),s.useState("");const ee=async a=>{try{await Promise.all([a()]),u(!1),N(r=>r=!1)}catch(r){console.error("Error fetching data:",r)}},d=async()=>{u(!0);let r=await(await fetch("/api/products")).json();_(H=>r),u(!1)};s.useEffect(()=>{(async()=>{try{await Promise.all([d()]),u(!1),N(r=>r=!1)}catch(r){console.error("Error fetching data:",r)}})()},[]);let I=[{name:"Produk"},{name:"Layanan"}];const ae=a=>e.jsx(ce.Fragment,{children:e.jsx("i",{className:"pi pi-ellipsis-h pointer cursor-pointer",onClick:r=>{B(a),S.current.toggle(r)}})}),c=a=>{b.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},m=a=>{b.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},re=a=>{t(r=>({...r,uuid:a.uuid})),t(r=>({...r,name:a.name})),t(r=>({...r,category:a.category})),t(r=>({...r,price:a.price})),t(r=>({...r,unit:a.unit})),t(r=>({...r,description:a.description})),x(!0)},te=()=>{Z("products/"+k.uuid,{onSuccess:()=>{d(),c("Hapus")},onError:()=>{m("Hapus")}})},se=()=>{ge({message:"Apakah Anda yakin untuk menghapus ini?",header:"Konfirmasi hapus",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:()=>{v(!0)}})},le=(()=>e.jsx(xe,{filters:D,setFilters:Q}))(),ie=()=>e.jsx("i",{className:"pi pi-plus",style:{fontSize:"0.7rem",paddingRight:"5px"}}),F=(a,r)=>{a.preventDefault(),r==="tambah"?X("/products",{onSuccess:()=>{c("Tambah"),f(H=>!1),d(),w("name","category","price","unit","description")},onError:()=>{m("Tambah")}}):Y("/products/"+l.uuid,{onSuccess:()=>{c("Update"),x(H=>!1),d(),w("name","category","price","unit","description")},onError:()=>{m("Update")}})},T=[{field:"name",header:"Nama",frozen:!i,style:i?null:{width:"max-content",whiteSpace:"nowrap"}},{field:"category",header:"Kategori",frozen:!i,style:i?null:{width:"max-content",whiteSpace:"nowrap"}},{field:"price",header:"Harga",frozen:!i,style:i?null:{width:"max-content",whiteSpace:"nowrap"},body:a=>a.price.toLocaleString("id-ID")},{field:"unit",header:"Unit",frozen:!i,style:i?null:{width:"max-content",whiteSpace:"nowrap"}},{field:"description",header:"Deskripsi",frozen:!i,style:i?null:{width:"max-content",whiteSpace:"nowrap"}}],oe=a=>{let r;return a=="name"?r="Nama":a=="category"?r="Kategori":a=="price"?r="Harga":a=="unit"?r="Unit":a=="price"?r="Harga":a=="description"&&(r="Deskripsi"),r},L=["name","category"];return W?e.jsx(be,{auth:n}):e.jsxs(ue,{auth:n.user,className:"",children:[e.jsx(pe,{ref:b}),e.jsx(we,{className:" shadow-md p-1 dark:bg-slate-900 dark:text-gray-300",ref:S,children:e.jsxs("div",{className:"flex flex-col flex-wrap w-full",children:[e.jsx(p,{icon:"pi pi-pencil",label:"edit",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{re(k)}}),e.jsx(p,{icon:"pi pi-trash",label:"hapus",className:"bg-transparent hover:bg-slate-200 w-full text-slate-500 border-b-2 border-slate-400",onClick:()=>{se()}})]})}),e.jsx(he,{title:"Produk",children:J.includes("tambah produk")&&e.jsx(p,{label:"Tambah",className:"bg-purple-600 text-sm shadow-md rounded-lg mr-2",icon:ie,onClick:()=>{f(a=>!0),w("name","category","price","unit","description")},"aria-controls":"popup_menu_right","aria-haspopup":!0})}),e.jsxs(je,{activeIndex:o,onTabChange:a=>{A(a.index)},className:"mt-2",children:[e.jsx(j,{header:"Semua Produk",children:o==0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(z,{group:"declarative",visible:$,onHide:()=>v(!1),message:"Konfirmasi kembali jika anda yakin!",header:"Konfirmasi kembali",icon:"pi pi-info-circle",accept:te}),e.jsx("div",{className:"flex mx-auto flex-col justify-center mt-5 gap-5",children:e.jsx("div",{className:"card p-fluid w-full h-full flex justify-center rounded-lg",children:e.jsxs(me,{loading:O,className:"w-full h-auto rounded-lg dark:glass border-none text-center shadow-md",pt:{bodyRow:"dark:bg-transparent bg-transparent dark:text-gray-300",table:"dark:bg-transparent bg-white dark:text-gray-300",header:""},paginator:!0,rowsPerPageOptions:[5,10,25,50],paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} - {last} dari {totalRecords}",filters:D,rows:10,emptyMessage:"Produk tidak ditemukan.",paginatorClassName:"dark:bg-transparent paginator-custome dark:text-gray-300 rounded-b-lg",header:le,globalFilterFields:L,value:M,dataKey:"id",children:[e.jsx(h,{header:"Aksi",body:ae,style:{width:"max-content",whiteSpace:"nowrap"},frozen:!0,align:"center",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"}),T.map(a=>e.jsx(h,{field:a.field,header:a.header,body:a.body,style:a.style,frozen:a.frozen,align:"left",className:"dark:border-none bg-white",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300"})),e.jsx(h,{field:"created_at",className:"dark:border-none bg-white lg:whitespace-nowrap lg:w-max",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300",header:"Tanggal Input",align:"left",body:a=>ye(a.created_at),style:{width:"max-content",whiteSpace:"nowrap"}}),e.jsx(h,{field:"created_by",className:"dark:border-none bg-white lg:whitespace-nowrap lg:w-max",headerClassName:"dark:border-none bg-white dark:bg-slate-900 dark:text-gray-300",header:"Diinput Oleh",align:"left",body:a=>a.created_by.name,style:{width:"max-content",whiteSpace:"nowrap"}})]})})})]})}),e.jsx(j,{header:"Log",children:o==1&&e.jsx(ke,{auth:n,fetchUrl:"/api/products/logs",filterUrl:"/products/logs/filter",deleteUrl:"/products/logs",objectKeyToIndo:oe,users:y,showSuccess:c,showError:m})}),e.jsx(j,{header:"Arsip",children:o==2&&e.jsx(ve,{auth:n,users:y,fetchUrl:"/api/products/arsip",forceDeleteUrl:"/products/{id}/force",restoreUrl:"/products/{id}/restore",filterUrl:"/products/arsip/filter",noFilter:!0,columns:T,showSuccess:c,showError:m,globalFilterFields:L})})]}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(E,{ref:C,header:"Produk",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:q,onHide:()=>f(!1),children:e.jsxs("form",{onSubmit:a=>F(a,"tambah"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Nama"}),e.jsx(g,{value:l.name,onChange:a=>t("name",a.target.value),className:"dark:bg-gray-300",id:"name","aria-describedby":"name-help"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Kategori"}),e.jsx(R,{value:l.category,onChange:a=>t("category",a.target.value),options:I,optionLabel:"name",placeholder:"Pilih Kategori",className:"w-full md:w-14rem"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"price",children:"Harga"}),e.jsx(K,{value:l.price,onValueChange:a=>t("price",a.target.value),locale:"id-ID"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"unit",children:"Unit"}),e.jsx(g,{className:"dark:bg-gray-300",value:l.unit,onChange:a=>t("unit",a.target.value),id:"unit","aria-describedby":"unit-help"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(U,{value:l.description,onChange:a=>t("description",a.target.value),rows:5,cols:30})]})]}),e.jsx("div",{className:"flex justify-center my-5",children:e.jsx(p,{label:"Submit",disabled:P,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})}),e.jsx("div",{className:"card flex justify-content-center",children:e.jsx(E,{ref:C,header:"Produk",headerClassName:"dark:glass shadow-md dark:text-white",className:"bg-white w-[80%] md:w-[60%] lg:w-[30%] dark:glass dark:text-white",contentClassName:" dark:glass dark:text-white",visible:G,onHide:()=>x(!1),children:e.jsxs("form",{onSubmit:a=>F(a,"update"),children:[e.jsxs("div",{className:"flex flex-col justify-around gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"name",children:"Nama"}),e.jsx(g,{value:l.name,onChange:a=>t("name",a.target.value),className:"dark:bg-gray-300",id:"name","aria-describedby":"name-help"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"category",children:"Kategori"}),e.jsx(R,{optionValue:"name",value:l.category,optionLabel:"name",onChange:a=>t("category",a.target.value),options:I,placeholder:"Pilih Kategori",className:"w-full md:w-14rem dark:bg-gray-300"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"price",children:"Harga"}),e.jsx(K,{value:l.price,onValueChange:a=>t("price",a.target.value),locale:"id-ID"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"unit",children:"Unit"}),e.jsx(g,{className:"dark:bg-gray-300",value:l.unit,onChange:a=>t("unit",a.target.value),id:"unit","aria-describedby":"unit-help"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(U,{className:"dark:bg-gray-300",value:l.description,onChange:a=>t("description",a.target.value),rows:5,cols:30})]})]}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(p,{label:"Submit",disabled:P,className:"bg-purple-600 text-sm shadow-md rounded-lg"})})]})})})]})}export{pa as default};
