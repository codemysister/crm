import{r as l,W as ye,F as we,j as e,a as ke,d as Se,y as Pe}from"./app-183ca207.js";import{I as d}from"./inputtext.esm-0c7f541c.js";import{C as _e}from"./card.esm-aad9a2fd.js";import{B as p}from"./button.esm-d3cd2157.js";import{D as Ce,C as x}from"./column.esm-1f1d87c0.js";import{D as z}from"./dialog.esm-202fdef4.js";import{D as T}from"./dropdown.esm-0caba294.js";import{T as Re}from"./toast.esm-b97f2233.js";import{B as Fe}from"./badge.esm-c550247d.js";import{I}from"./inputnumber.esm-6c4b14f0.js";import{I as m}from"./InputError-6be719bf.js";import{D as De,S as Te}from"./DialogInstitution-405a9aff.js";import{H as Ie}from"./HeaderDatatable-497e5508.js";import{a as Le,g as Be}from"./getProvince-aa058a1f.js";import{B as Ee,L as He}from"./blockui.esm-74c21695.js";import"./ripple.esm-4b355069.js";import"./portal.esm-545bb246.js";import"./index.esm-9ef49f43.js";import"./index.esm-dca36cda.js";import"./index.esm-64ce51d8.js";import"./csstransition.esm-03d4c013.js";import"./inheritsLoose-2f6bfe9f.js";import"./index.esm-80aa95ee.js";import"./index.esm-c27cbd20.js";import"./assertThisInitialized-081f9914.js";import"./formatNPWP-cf5b7efc.js";import"./progressspinner.esm-5c964cda.js";const ja=({usersProp:Ae,partnersProp:W,salesProp:U,productsProp:$,sph:t,signaturesProp:G})=>{var M,V,q;const[Y,Z]=l.useState(W),[X,Q]=l.useState(null),[ee,Ke]=l.useState(U);l.useState(G);const[ae,Oe]=l.useState($),[se,le]=l.useState(!1),[re,b]=l.useState(!1),[te,N]=l.useState(!1),[ne,L]=l.useState(!1),[ie,Je]=l.useState(!0),y=l.useRef(null),[B,E]=l.useState(""),[ce,oe]=l.useState([]),[de,me]=l.useState([]),[w,k]=l.useState(null),[ue,H]=l.useState(!1),[A,Me]=l.useState(localStorage.theme);l.useEffect(()=>{A?localStorage.theme="dark":localStorage.removeItem("theme"),localStorage.theme==="dark"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[A]);const S=l.useRef(null),pe=l.useRef(null),f=l.useRef(null),g=l.useRef(null),j=l.useRef(null),P=l.useRef(null),_=l.useRef(null),he=l.useRef(null),{data:s,setData:i,post:Ve,put:xe,delete:qe,reset:fe,processing:K,errors:o}=ye({uuid:"",code:`${Math.floor(Math.random()*1e3)}/CAZH-SPH/X/${new Date().getFullYear()}`,products:[],partner:{id:t.partner==null?t.lead.id:t.partner.id,uuid:t.partner==null?t.lead.uuid:t.partner.uuid,name:t.partner_name,province:t.partner_province,regency:t.partner_regency,pic:t.partner_pic,type:t.partner==null?"lead":"partner"},sales:{name:t.sales_name,email:t.sales_email,wa:t.sales_wa},created_by:null,signature:{name:t.signature_name,position:t.signature_position,image:t.signature_image},products:t.products});l.useEffect(()=>{const a=async()=>{let r=await Le();oe(h=>r)};k(JSON.parse(s.partner.province).name),a()},[]),l.useEffect(()=>{H(!!K)},[K]),l.useEffect(()=>{(async()=>{if(w){let r=await Be(w);me(h=>r)}})()},[w]);const[C,O]=l.useState({global:{value:null,matchMode:we.CONTAINS}});document.querySelector("body").classList.add("overflow-hidden");const c=a=>(a.current&&(a.current.classList.add("twinkle"),a.current.focus()),null),u=a=>(a.current.classList.remove("twinkle"),null),J=a=>e.jsx(p,{label:"OK",icon:"pi pi-check",onClick:()=>a!="product"?b(!1):be()}),R=(a,r)=>a?e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}):e.jsx("span",{children:r.placeholder}),F=a=>e.jsx("div",{className:"flex align-items-center",children:e.jsx("div",{children:a.name})}),ge=()=>e.jsx(Ie,{filters:C,setFilters:O,children:e.jsx(Te,{className:"w-full flex justify-end lg:text-md text-center",value:institutionType,onChange:a=>setInstitutionType(a.value),options:institutionTypeOptions})}),je=a=>{y.current.show({severity:"success",summary:"Success",detail:`${a} data berhasil`,life:3e3})},ve=a=>{y.current.show({severity:"error",summary:"Error",detail:`${a} data gagal`,life:3e3})},be=()=>{const a=[...s.products,...B];i("products",a),N(!1),E(r=>[])},v=(a,r,h)=>{const n=[...s.products];if(n[a][r]=h,r=="price"||r=="qty"){let D=n[a].price*n[a].qty;n[a].total=D}i("products",n)},Ne=a=>{a.preventDefault(),xe("/sph/"+t.uuid,{onSuccess:()=>{je("Update"),Pe.get("/sph")},onError:()=>{ve("Tambah")}})};return e.jsxs(e.Fragment,{children:[e.jsx(ke,{title:"Surat Penawaran Harga"}),e.jsx(Re,{ref:y}),e.jsx(Ee,{blocked:ue,template:He,children:e.jsx("div",{className:"h-screen max-h-screen overflow-y-hidden",children:e.jsxs("div",{className:"flex flex-col h-screen max-h-screen overflow-hidden md:flex-row z-40 relative gap-5",children:[e.jsx("div",{className:"md:w-[35%] overflow-y-auto h-screen max-h-screen p-5",children:e.jsxs(_e,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"font-bold text-2xl",children:"Surat Penawaran Harga"}),e.jsx(Se,{href:"/sph",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6",children:e.jsx("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"})})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(p,{label:"Tambah Produk",icon:"pi pi-external-link",onClick:()=>b(!0)}),e.jsx(m,{message:o.products,className:"mt-2"}),e.jsx("div",{className:"flex flex-col mt-3",children:e.jsx(d,{value:s.code,onChange:a=>i("code",a.target.value),className:"dark:bg-gray-300",id:"code","aria-describedby":"code-help",hidden:!0})}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"lembaga",children:"Lembaga *"}),e.jsx(d,{value:s.partner.name,onFocus:()=>{c(S)},onBlur:()=>{u(S)},onClick:()=>{L(!0)},placeholder:"Pilih lembaga",className:"dark:bg-gray-300 cursor-pointer",id:"partner","aria-describedby":"partner-help"}),e.jsx(m,{message:o["partner.name"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"partner_pic",children:"PIC *"}),e.jsx(d,{value:s.partner.pic,onChange:a=>i("partner",{...s.partner,pic:a.target.value}),className:"dark:bg-gray-300",id:"partner_pic","aria-describedby":"partner_pic-help",onFocus:()=>{c(g)},onShow:()=>{c(g)},onBlur:()=>{u(g)}})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"province",children:"Provinsi *"}),e.jsx(T,{value:s.partner.province?JSON.parse(s.partner.province):null,onChange:a=>{k(r=>a.target.value.code),i("partner",{...s.partner,province:JSON.stringify(a.target.value),regency:null})},dataKey:"code",options:ce,optionLabel:"name",placeholder:"Pilih Provinsi",filter:!0,valueTemplate:R,itemTemplate:F,className:"w-full md:w-14rem",onFocus:()=>{c(f)},onShow:()=>{c(f)},onBlur:()=>{u(f)}}),e.jsx(m,{message:o["partner.province"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"regency",children:"Kabupaten *"}),e.jsx(T,{dataKey:"code",value:s.partner.regency?JSON.parse(s.partner.regency):null,onChange:a=>{i("partner",{...s.partner,regency:JSON.stringify(a.target.value)})},options:de,optionLabel:"name",placeholder:"Pilih Kabupaten",filter:!0,valueTemplate:R,itemTemplate:F,className:"w-full md:w-14rem"}),e.jsx(m,{message:o["partner.regency"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales",children:"Sales *"}),e.jsx(T,{dataKey:"name",value:s.sales,onChange:a=>{i("sales",{...s.sales,name:a.target.value.name,wa:a.target.value.number,email:a.target.value.email})},options:ee,optionLabel:"name",placeholder:"Pilih Sales",filter:!0,valueTemplate:R,itemTemplate:F,className:"w-full md:w-14rem",onFocus:()=>{c(j)},onShow:()=>{c(j)},onBlur:()=>{u(j)}}),e.jsx(m,{message:o["sales.name"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales-whatsapp",children:"Whatsapp Sales *"}),e.jsx(d,{value:s.sales.wa,onChange:a=>{i("sales",{...s.sales,wa:a.target.value})},keyfilter:"int",className:"dark:bg-gray-300",id:"sales-whatsapp","aria-describedby":"sales-whatsapp-help",onFocus:()=>{c(P)},onBlur:()=>{u(P)}}),e.jsx(m,{message:o["sales.wa"],className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col mt-3",children:[e.jsx("label",{htmlFor:"sales-email",children:"Email Sales *"}),e.jsx(d,{value:s.sales.email,onChange:a=>i("sales",{...s.sales,email:a.target.value}),className:"dark:bg-gray-300",id:"sales-email","aria-describedby":"sales-email-help",onFocus:()=>{c(_)},onBlur:()=>{u(_)}}),e.jsx(m,{message:o["sales.email"],className:"mt-2"})]}),e.jsx("div",{className:"flex-flex-col mt-3",children:e.jsx("form",{onSubmit:Ne,children:e.jsx(p,{className:"mx-auto justify-center block",children:"Submit"})})})]})]})}),e.jsxs(z,{header:"Input Produk",visible:re,style:{width:"85vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>b(!1),footer:J,children:[e.jsxs("div",{className:"flex my-5 gap-3",children:[e.jsx(p,{label:"Pilh Produk",icon:"pi pi-external-link",onClick:()=>N(!0),className:"text-xs md:text-base"}),e.jsx(p,{label:"Tambah Produk",icon:"pi pi-plus",className:"text-xs md:text-base",onClick:()=>{let a={name:"",price:"",qty:"",detail:null,total:""},r=[...s.products,a];i("products",r)}})]}),(M=s.products)==null?void 0:M.map((a,r)=>{const h=r+1;return e.jsxs("div",{className:"flex gap-5 mt-2 items-center",children:[e.jsx("div",{children:e.jsx(Fe,{value:h,size:"large"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Produk/Layanan *"}),e.jsx(d,{value:a.name,onChange:n=>v(r,"name",n.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Harga *"}),e.jsx(I,{value:a.price,onChange:n=>v(r,"price",n.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",locale:"id"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Kuantitas *"}),e.jsx(I,{value:a.qty,onChange:n=>v(r,"qty",n.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",locale:"id"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Rincian *"}),e.jsx(d,{value:a.detail,onChange:n=>v(r,"detail",n.target.value),className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help"})]})}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"partner_address",children:"Jumlah *"}),e.jsx(I,{value:a.total,className:"dark:bg-gray-300",id:"partner_address","aria-describedby":"partner_address-help",disabled:!0,locale:"id"})]})}),e.jsx("div",{className:"flex self-center pt-4 ",children:e.jsx(p,{className:"bg-red-500 h-1 w-1 shadow-md rounded-full ",icon:()=>e.jsx("i",{className:"pi pi-minus",style:{fontSize:"0.7rem"}}),onClick:()=>{const n=[...s.products];n.splice(r,1),i(D=>({...D,products:n}))},"aria-controls":"popup_menu_right","aria-haspopup":!0})})]},a+r)}),e.jsx(z,{header:"Produk",visible:te,style:{width:"75vw"},maximizable:!0,modal:!0,contentStyle:{height:"550px"},onHide:()=>N(!1),footer:()=>J("product"),children:e.jsxs(Ce,{value:ae,paginator:!0,filters:C,rows:5,header:ge,scrollable:!0,scrollHeight:"flex",tableStyle:{minWidth:"50rem"},selectionMode:ie?null:"checkbox",selection:B,onSelectionChange:a=>E(a.value),dataKey:"id",children:[e.jsx(x,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),e.jsx(x,{field:"name",header:"Name"}),e.jsx(x,{field:"description",header:"Deskripsi"}),e.jsx(x,{field:"category",header:"Kategori"}),e.jsx(x,{field:"price",header:"Harga"})]})})]}),e.jsxs("div",{className:"md:w-[65%] hidden md:block text-sm h-screen max-h-screen overflow-y-auto p-5",children:[e.jsx("header",{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"w-full",children:e.jsx("img",{src:"/assets/img/cazh.png",alt:"",className:"float-left w-1/3 h-1/3"})}),e.jsxs("div",{className:"w-full text-right text-xs",children:[e.jsx("h2",{className:"font-bold",children:"PT CAZH TEKNOLOGI INOVASI"}),e.jsx("p",{children:"Bonavida Park D1, Jl. Raya Karanggintung"}),e.jsx("p",{children:"Kec. Sumbang, Kab. Banyumas,Jawa Tengah 53183"}),e.jsx("p",{children:"hello@cards.co.id | https://cards.co.id"})]})]})}),e.jsxs("div",{className:"text-center mt-5",children:[e.jsx("h1",{className:"font-bold underline mx-auto",children:"SURAT PENAWARAN HARGA"}),e.jsxs("p",{className:"",children:["Nomor : ",e.jsx("b",{children:s.code})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h1",{children:"Kepada Yth."}),e.jsx("h1",{className:"font-bold",ref:pe,children:s.partner.pic??"{{pic}}"}),e.jsx("h1",{className:"font-bold",ref:S,children:s.partner.name??"{{partner}}"}),e.jsxs("h1",{children:["di"," ",e.jsx("span",{ref:g,children:s.partner.regency?JSON.parse(s.partner.regency).name:"{{alamat}}"}),", ",e.jsx("span",{ref:f,children:s.partner.province?JSON.parse(s.partner.province).name:"{{alamat}}"})]})]}),e.jsx("div",{className:"mt-5",children:e.jsx("h1",{children:"Dengan Hormat"})}),e.jsx("div",{className:"mt-5",children:e.jsxs("h1",{children:["Menindaklanjuti komunikasi yang telah dilakukan oleh tim marketing kami"," ",s.sales.name??"{{sales}}"," dengan perwakilan dari"," ",s.partner.name??"{{partner}}",", dengan ini kami sampaikan penawaran sebagai berikut:"]})}),e.jsx("div",{className:"w-full mt-5",children:e.jsxs("table",{className:"w-full",children:[e.jsxs("thead",{className:"bg-blue-100 text-left",children:[e.jsx("th",{className:"pl-2",children:"No"}),e.jsx("th",{className:"py-2",children:"Produk/Layanan"}),e.jsx("th",{className:"py-2",children:"Rincian"}),e.jsx("th",{className:"py-2 text-center",children:"Jumlah"})]}),e.jsxs("tbody",{children:[((V=s.products)==null?void 0:V.length)==0&&e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:4,children:"Produk belum ditambah"})}),(q=s.products)==null?void 0:q.map((a,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"pl-2",children:++r}),e.jsx("td",{children:a.name}),e.jsx("td",{children:a.detail}),e.jsxs("td",{className:"text-right px-4",children:["Rp",a.total?a.total.toLocaleString("id"):0]})]},a.name+r))]})]})}),e.jsx("div",{class:"mt-6",children:e.jsx("div",{class:"text-sm text-left w-full",children:"*) Harga yang tertera belum termasuk PPN sebesar 11%."})}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h1",{children:"Untuk konfirmasi persetujuan silakan hubungi :"}),e.jsxs("h1",{children:[e.jsx("b",{ref:j,children:s.sales.name??"{{sales}}"})," ","via WA :"," ",e.jsx("b",{ref:P,children:s.sales.wa??"{{wa_sales}}"}),", email :"," ",e.jsx("b",{ref:_,children:s.sales.email??"{{email_sales}}"})]})]}),e.jsx("div",{className:"mt-5",children:e.jsx("h1",{children:"Demikian surat penawaran harga ini kami sampaikan dengan sesungguhnya. Atas perhatian dan kerja sama yang baik, kami sampaikan terima kasih."})}),e.jsxs("div",{className:"flex flex-col mt-5 justify-start w-[30%]",ref:he,children:[e.jsxs("p",{children:["Purwokerto,"," ",new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]}),e.jsxs("div",{className:"h-[100px] w-[170px] self-start py-2",children:[e.jsx("img",{src:s.signature.image,alt:"",className:"object-fill w-full h-full"}),e.jsx("p",{children:s.signature.name})]})]})]})]})})}),e.jsx(De,{dialogInstitutionVisible:ne,setDialogInstitutionVisible:L,filters:C,setFilters:O,isLoadingData:se,setIsLoadingData:le,leads:X,setLeads:Q,partners:Y,setPartners:Z,data:s,setData:i,reset:fe,setProvinceName:k})]})};export{ja as default};
